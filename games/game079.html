<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„ÇΩ„É™„ÉÜ„Ç£„Ç¢ - „Ç≤„Éº„É†079</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 20px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 1400px;
            width: 100%;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .game-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-description {
            font-size: 1.1rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 120px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .solitaire-board {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            min-height: 500px;
            display: grid;
            grid-template-rows: auto auto 1fr;
            gap: 20px;
        }

        .top-area {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
        }

        .foundation-area {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .tableau-area {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            min-height: 350px;
        }

        .card-pile {
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 5px;
            position: relative;
        }

        .card-pile.foundation {
            background: rgba(46, 204, 113, 0.2);
            border-color: #2ecc71;
        }

        .card-pile.waste {
            background: rgba(52, 152, 219, 0.2);
            border-color: #3498db;
        }

        .playing-card {
            background: white;
            color: #333;
            border: 1px solid #333;
            border-radius: 6px;
            width: 60px;
            height: 85px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: bold;
            padding: 4px;
            margin-top: -60px;
            position: relative;
        }

        .playing-card:first-child {
            margin-top: 0;
        }

        .playing-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .playing-card.selected {
            border-color: #f1c40f;
            border-width: 3px;
            transform: translateY(-8px);
        }

        .playing-card.red {
            color: #e74c3c;
        }

        .playing-card.black {
            color: #333;
        }

        .playing-card.face-down {
            background: #2c3e50;
            color: white;
            cursor: pointer;
        }

        .card-value {
            font-size: 14px;
            font-weight: bold;
        }

        .card-suit {
            font-size: 18px;
        }

        .card-back {
            background: #2c3e50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .stock-pile {
            background: rgba(155, 89, 182, 0.2);
            border-color: #9b59b6;
            cursor: pointer;
        }

        .stock-pile:hover {
            background: rgba(155, 89, 182, 0.3);
        }

        .pile-label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #f1c40f;
            font-weight: bold;
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.primary {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .btn.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .instructions h3 {
            color: #f1c40f;
            margin-bottom: 15px;
            text-align: center;
        }

        .instructions ul {
            margin-left: 20px;
        }

        .instructions li {
            margin: 8px 0;
            line-height: 1.4;
        }

        .game-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .solitaire-board {
                padding: 15px;
            }

            .playing-card {
                width: 45px;
                height: 65px;
                font-size: 10px;
                margin-top: -45px;
            }

            .card-suit {
                font-size: 14px;
            }

            .tableau-area {
                grid-template-columns: repeat(7, 1fr);
                gap: 5px;
            }

            .foundation-area {
                gap: 5px;
            }

            .game-container {
                padding: 20px;
            }

            .stat {
                min-width: 100px;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href = '../index.html'">‚Üê „É°„Éã„É•„Éº„Å´Êàª„Çã</button>

    <div class="game-container">
        <h1 class="game-title">‚ô†Ô∏è „ÇΩ„É™„ÉÜ„Ç£„Ç¢</h1>
        <p class="game-description">Êà¶Áï•ÁöÑËß£Ê≥ï„Å®Ë´ñÁêÜÁöÑÊÄùËÄÉ„Å´„Çà„ÇãÂïèÈ°åËß£Ê±∫„Ç≤„Éº„É†</p>

        <div class="game-stats">
            <div class="stat">
                <div class="stat-label">ÂÆåÊàê„Ç≤„Éº„É†</div>
                <div class="stat-value" id="completedGames">0/10</div>
            </div>
            <div class="stat">
                <div class="stat-label">ÂÆåÊàêÁéá</div>
                <div class="stat-value" id="completionRate">0%</div>
            </div>
            <div class="stat">
                <div class="stat-label">ÊúÄÂ∞èÊâãÊï∞</div>
                <div class="stat-value" id="bestMoves">--</div>
            </div>
            <div class="stat">
                <div class="stat-label">„ÇÑ„ÇäÁõ¥„ÅóÂõûÊï∞</div>
                <div class="stat-value" id="retryCount">0/3</div>
            </div>
        </div>

        <div class="game-info">
            <div id="gameStatus">Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
        </div>

        <div class="solitaire-board">
            <div class="top-area">
                <div class="card-pile stock-pile" id="stockPile" onclick="drawCard()">
                    <div class="pile-label">Â±±Êú≠</div>
                    <div class="card-back">üÇ†</div>
                </div>
                
                <div class="card-pile waste" id="wastePile">
                    <div class="pile-label">„ÇÅ„Åè„ÇäÊú≠</div>
                </div>
                
                <div class="foundation-area">
                    <div class="card-pile foundation" id="foundation0">
                        <div class="pile-label">‚ô†Ô∏è</div>
                    </div>
                    <div class="card-pile foundation" id="foundation1">
                        <div class="pile-label">‚ô•Ô∏è</div>
                    </div>
                    <div class="card-pile foundation" id="foundation2">
                        <div class="pile-label">‚ô£Ô∏è</div>
                    </div>
                    <div class="card-pile foundation" id="foundation3">
                        <div class="pile-label">‚ô¶Ô∏è</div>
                    </div>
                </div>
            </div>

            <div class="tableau-area">
                <div class="card-pile" id="tableau0"></div>
                <div class="card-pile" id="tableau1"></div>
                <div class="card-pile" id="tableau2"></div>
                <div class="card-pile" id="tableau3"></div>
                <div class="card-pile" id="tableau4"></div>
                <div class="card-pile" id="tableau5"></div>
                <div class="card-pile" id="tableau6"></div>
            </div>
        </div>

        <div class="controls">
            <button class="btn primary" onclick="newGame()">Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†</button>
            <button class="btn warning" onclick="restartGame()" id="restartBtn" disabled>„ÇÑ„ÇäÁõ¥„Åó</button>
            <button class="btn" onclick="autoMove()">Ëá™ÂãïÁßªÂãï</button>
            <button class="btn" onclick="showHint()">„Éí„É≥„Éà</button>
        </div>

        <div class="instructions">
            <h3>üìã Ë©≥Á¥∞„É´„Éº„É´„ÉªÈÅä„Å≥Êñπ</h3>
            <ul>
                <li><strong>ÁõÆÁöÑ:</strong> „ÇØ„É≠„É≥„ÉÄ„Ç§„ÇØÂΩ¢Âºè„ÇΩ„É™„ÉÜ„Ç£„Ç¢„Çí80%‰ª•‰∏ä„ÅÆÂÆåÊàêÁéá„Åß„ÇØ„É™„Ç¢Ôºà10„Ç≤„Éº„É†‰∏≠8„Ç≤„Éº„É†ÂÆåÊàêÔºâ</li>
                <li><strong>Âü∫Êú¨„É´„Éº„É´:</strong>
                    <ul>
                        <li>ÂÖ®„Å¶„ÅÆ„Ç´„Éº„Éâ„Çí4„Å§„ÅÆÂü∫Á§éÊù≠Ôºà‚ô†Ô∏è‚ô•Ô∏è‚ô£Ô∏è‚ô¶Ô∏èÔºâ„Å´A„ÄúK„ÅÆÈ†Ü„ÅßÁ©ç„Åø‰∏ä„Åí„Çã</li>
                        <li>Â†¥Êú≠„Åß„ÅØËµ§„Å®Èªí„Åå‰∫§‰∫í„Å´„Å™„Çã„Çà„ÅÜ„ÄÅÂ§ß„Åç„ÅÑÊï∞„Åã„ÇâÂ∞è„Åï„ÅÑÊï∞„ÅÆÈ†Ü„ÅßÁ©ç„ÇÄ</li>
                        <li>Ë°®Âêë„Åç„ÅÆ„Ç´„Éº„Éâ„ÅÆ„ÅøÁßªÂãïÂèØËÉΩ„ÄÅË£èÂêë„Åç„Ç´„Éº„Éâ„Åå„ÇÅ„Åè„Çå„Åü„ÇâË°®„Å´„Åô„Çã</li>
                    </ul>
                </li>
                <li><strong>Êìç‰ΩúÊñπÊ≥ï:</strong>
                    <ul>
                        <li>„Ç´„Éº„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈÅ∏Êäû„ÄÅ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÇØ„É™„ÉÉ„ÇØ„ÅßÁßªÂãïÂÖàÊ±∫ÂÆö</li>
                        <li>Â±±Êú≠„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„Çí„ÇÅ„Åè„Çã</li>
                        <li>Á©∫„ÅÑ„ÅüÂ†¥Êú≠„ÅÆÂàó„Å´„ÅØ„Ç≠„É≥„Ç∞ÔºàKÔºâ„ÅÆ„ÅøÈÖçÁΩÆÂèØËÉΩ</li>
                        <li>Âü∫Á§éÊù≠„Å´„ÅØA„Åã„ÇâÈ†ÜÁï™„Å´Âêå„Åò„Çπ„Éº„Éà„ÅÆ„Ç´„Éº„Éâ„ÇíÁ©ç„ÇÄ</li>
                    </ul>
                </li>
                <li><strong>Êà¶Áï•Ë¶ÅÁ¥†:</strong> ÊúÄÂ∞èÊâãÊï∞„Åß„ÅÆÂÆåÊàê„ÄÅÊâãÈ†Ü„ÅÆÊúÄÈÅ©Âåñ„ÄÅÂÖàË™≠„ÅøÂà§Êñ≠</li>
                <li><strong>„ÇÑ„ÇäÁõ¥„Åó:</strong> 3Âõû„Åæ„ÅßÂêå„ÅòÈÖçÁΩÆ„Åß„ÅÆ„ÇÑ„ÇäÁõ¥„ÅóÂèØËÉΩ</li>
                <li><strong>Ë©ï‰æ°Âü∫Ê∫ñ:</strong> ÂÆåÊàêÁéá„ÄÅÊâãÊï∞ÂäπÁéá„ÄÅÊà¶Áï•ÁöÑÊÄùËÄÉÂäõ„ÄÅÂïèÈ°åËß£Ê±∫ËÉΩÂäõ</li>
                <li><strong>„ÇØ„É™„Ç¢Êù°‰ª∂:</strong> 10„Ç≤„Éº„É†‰∏≠8„Ç≤„Éº„É†‰ª•‰∏äÂÆåÊàêÔºàÂÆåÊàêÁéá80%‰ª•‰∏äÔºâ„Åß„ÇΩ„É™„ÉÜ„Ç£„Ç¢„Éû„Çπ„Çø„ÉºË™çÂÆö</li>
            </ul>
        </div>
    </div>

    <script>
        let gameState = {
            stock: [],
            waste: [],
            foundations: [[], [], [], []],
            tableau: [[], [], [], [], [], [], []],
            selectedCard: null,
            selectedPile: null,
            moves: 0,
            gamesPlayed: 0,
            gamesCompleted: 0,
            totalGames: 10,
            retryCount: 0,
            maxRetries: 3,
            gameActive: false,
            bestMoves: null
        };

        const suits = ['spades', 'hearts', 'clubs', 'diamonds'];
        const suitSymbols = {'spades': '‚ô†Ô∏è', 'hearts': '‚ô•Ô∏è', 'clubs': '‚ô£Ô∏è', 'diamonds': '‚ô¶Ô∏è'};
        const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

        function createDeck() {
            const deck = [];
            suits.forEach(suit => {
                values.forEach((value, index) => {
                    deck.push({
                        suit: suit,
                        value: value,
                        rank: index + 1,
                        color: (suit === 'hearts' || suit === 'diamonds') ? 'red' : 'black',
                        faceUp: false
                    });
                });
            });
            return shuffleDeck(deck);
        }

        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        function dealCards() {
            const deck = createDeck();
            
            // „Çø„Éñ„É≠„Éº„Å´ÈÖç„Çã
            let cardIndex = 0;
            for (let col = 0; col < 7; col++) {
                gameState.tableau[col] = [];
                for (let row = 0; row <= col; row++) {
                    const card = deck[cardIndex++];
                    card.faceUp = (row === col); // ÊúÄÂæå„ÅÆ„Ç´„Éº„Éâ„ÅÆ„ÅøË°®Âêë„Åç
                    gameState.tableau[col].push(card);
                }
            }
            
            // ÊÆã„Çä„ÇíÂ±±Êú≠„Å´
            gameState.stock = deck.slice(cardIndex);
            gameState.waste = [];
            gameState.foundations = [[], [], [], []];
            gameState.moves = 0;
            gameState.selectedCard = null;
            gameState.selectedPile = null;
            gameState.gameActive = true;
            
            updateDisplay();
        }

        function renderCard(card, clickHandler = null) {
            const cardElement = document.createElement('div');
            cardElement.className = `playing-card ${card.color}`;
            
            if (!card.faceUp) {
                cardElement.className += ' face-down';
                cardElement.innerHTML = '<div class="card-back">üÇ†</div>';
            } else {
                cardElement.innerHTML = `
                    <div class="card-value">${card.value}</div>
                    <div class="card-suit">${suitSymbols[card.suit]}</div>
                `;
            }
            
            if (clickHandler) {
                cardElement.onclick = clickHandler;
            }
            
            return cardElement;
        }

        function updateDisplay() {
            // Â±±Êú≠Ë°®Á§∫
            const stockPile = document.getElementById('stockPile');
            stockPile.innerHTML = '<div class="pile-label">Â±±Êú≠</div>';
            if (gameState.stock.length > 0) {
                stockPile.appendChild(renderCard({faceUp: false}, drawCard));
            }
            
            // „ÇÅ„Åè„ÇäÊú≠Ë°®Á§∫
            const wastePile = document.getElementById('wastePile');
            wastePile.innerHTML = '<div class="pile-label">„ÇÅ„Åè„ÇäÊú≠</div>';
            if (gameState.waste.length > 0) {
                const topCard = gameState.waste[gameState.waste.length - 1];
                wastePile.appendChild(renderCard(topCard, () => selectCard(topCard, 'waste')));
            }
            
            // Âü∫Á§éÊù≠Ë°®Á§∫
            for (let i = 0; i < 4; i++) {
                const foundation = document.getElementById(`foundation${i}`);
                foundation.innerHTML = `<div class="pile-label">${suitSymbols[suits[i]]}</div>`;
                
                if (gameState.foundations[i].length > 0) {
                    const topCard = gameState.foundations[i][gameState.foundations[i].length - 1];
                    foundation.appendChild(renderCard(topCard, () => selectCard(topCard, `foundation${i}`)));
                } else {
                    foundation.onclick = () => moveToFoundation(i);
                }
            }
            
            // „Çø„Éñ„É≠„ÉºË°®Á§∫
            for (let i = 0; i < 7; i++) {
                const tableau = document.getElementById(`tableau${i}`);
                tableau.innerHTML = '';
                
                gameState.tableau[i].forEach((card, index) => {
                    const cardElement = renderCard(card, () => selectCard(card, `tableau${i}`, index));
                    tableau.appendChild(cardElement);
                });
                
                if (gameState.tableau[i].length === 0) {
                    tableau.onclick = () => moveToTableau(i);
                }
            }
            
            updateStats();
            updateButtons();
        }

        function selectCard(card, pileType, cardIndex = null) {
            if (!gameState.gameActive) return;
            
            // ÈÅ∏ÊäûËß£Èô§
            document.querySelectorAll('.playing-card').forEach(el => {
                el.classList.remove('selected');
            });
            
            if (gameState.selectedCard === card) {
                gameState.selectedCard = null;
                gameState.selectedPile = null;
                return;
            }
            
            // ÁßªÂãïÂèØËÉΩ„Å™„Ç´„Éº„Éâ„ÅÆ„ÅøÈÅ∏ÊäûÂèØËÉΩ
            if (pileType.startsWith('tableau')) {
                const pileIndex = parseInt(pileType.replace('tableau', ''));
                const pile = gameState.tableau[pileIndex];
                if (cardIndex !== pile.length - 1) {
                    // „Çø„Éñ„É≠„Éº„Åß„ÅØ‰∏ÄÁï™‰∏ä„ÅÆ„Ç´„Éº„Éâ„ÅÆ„ÅøÈÅ∏ÊäûÂèØËÉΩ
                    return;
                }
            }
            
            if (!card.faceUp) return;
            
            gameState.selectedCard = card;
            gameState.selectedPile = pileType;
            
            // ÈÅ∏Êäû„Åï„Çå„Åü„Ç´„Éº„Éâ„Çí„Éè„Ç§„É©„Ç§„Éà
            event.target.classList.add('selected');
        }

        function drawCard() {
            if (gameState.stock.length === 0) {
                // Â±±Êú≠„ÅåÁ©∫„ÅÆÂ†¥Âêà„ÄÅ„ÇÅ„Åè„ÇäÊú≠„ÇíÂ±±Êú≠„Å´Êàª„Åô
                gameState.stock = gameState.waste.reverse();
                gameState.stock.forEach(card => card.faceUp = false);
                gameState.waste = [];
            } else {
                // Â±±Êú≠„Åã„Çâ„ÇÅ„Åè„ÇäÊú≠„Å´
                const card = gameState.stock.pop();
                card.faceUp = true;
                gameState.waste.push(card);
            }
            
            gameState.moves++;
            updateDisplay();
        }

        function moveToFoundation(foundationIndex) {
            if (!gameState.selectedCard) return;
            
            const card = gameState.selectedCard;
            const foundation = gameState.foundations[foundationIndex];
            
            // Âü∫Á§éÊù≠„Å∏„ÅÆÁßªÂãïÂèØËÉΩÊÄß„ÉÅ„Çß„ÉÉ„ÇØ
            if (foundation.length === 0) {
                if (card.rank !== 1) return; // A„ÅÆ„Åø
            } else {
                const topCard = foundation[foundation.length - 1];
                if (card.suit !== topCard.suit || card.rank !== topCard.rank + 1) return;
            }
            
            // „Ç´„Éº„Éâ„ÇíÁßªÂãï
            removeCardFromPile(gameState.selectedPile);
            foundation.push(card);
            
            gameState.moves++;
            gameState.selectedCard = null;
            gameState.selectedPile = null;
            
            checkForWin();
            updateDisplay();
        }

        function moveToTableau(tableauIndex) {
            if (!gameState.selectedCard) return;
            
            const card = gameState.selectedCard;
            const tableau = gameState.tableau[tableauIndex];
            
            // „Çø„Éñ„É≠„Éº„Å∏„ÅÆÁßªÂãïÂèØËÉΩÊÄß„ÉÅ„Çß„ÉÉ„ÇØ
            if (tableau.length === 0) {
                if (card.rank !== 13) return; // K„ÅÆ„Åø
            } else {
                const topCard = tableau[tableau.length - 1];
                if (card.color === topCard.color || card.rank !== topCard.rank - 1) return;
            }
            
            // „Ç´„Éº„Éâ„ÇíÁßªÂãï
            removeCardFromPile(gameState.selectedPile);
            tableau.push(card);
            
            gameState.moves++;
            gameState.selectedCard = null;
            gameState.selectedPile = null;
            
            updateDisplay();
        }

        function removeCardFromPile(pileType) {
            if (pileType === 'waste') {
                gameState.waste.pop();
            } else if (pileType.startsWith('foundation')) {
                const index = parseInt(pileType.replace('foundation', ''));
                gameState.foundations[index].pop();
            } else if (pileType.startsWith('tableau')) {
                const index = parseInt(pileType.replace('tableau', ''));
                const pile = gameState.tableau[index];
                pile.pop();
                
                // Êñ∞„Åó„ÅÑÊúÄ‰∏ä‰Ωç„Ç´„Éº„Éâ„ÇíË°®„Å´„Åô„Çã
                if (pile.length > 0 && !pile[pile.length - 1].faceUp) {
                    pile[pile.length - 1].faceUp = true;
                }
            }
        }

        function autoMove() {
            if (!gameState.gameActive) return;
            
            // Ëá™Âãï„ÅßÂü∫Á§éÊù≠„Å´ÁßªÂãï„Åß„Åç„Çã„Ç´„Éº„Éâ„ÇíÊé¢„Åô
            let moved = false;
            
            // „Çø„Éñ„É≠„Éº„Åã„Çâ
            for (let i = 0; i < 7; i++) {
                const pile = gameState.tableau[i];
                if (pile.length > 0) {
                    const card = pile[pile.length - 1];
                    if (card.faceUp && canMoveToFoundation(card)) {
                        removeCardFromPile(`tableau${i}`);
                        gameState.foundations[suits.indexOf(card.suit)].push(card);
                        gameState.moves++;
                        moved = true;
                        break;
                    }
                }
            }
            
            // „ÇÅ„Åè„ÇäÊú≠„Åã„Çâ
            if (!moved && gameState.waste.length > 0) {
                const card = gameState.waste[gameState.waste.length - 1];
                if (canMoveToFoundation(card)) {
                    gameState.waste.pop();
                    gameState.foundations[suits.indexOf(card.suit)].push(card);
                    gameState.moves++;
                    moved = true;
                }
            }
            
            if (moved) {
                checkForWin();
                updateDisplay();
            } else {
                alert('Ëá™ÂãïÁßªÂãï„Åß„Åç„Çã„Ç´„Éº„Éâ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
            }
        }

        function canMoveToFoundation(card) {
            const foundationIndex = suits.indexOf(card.suit);
            const foundation = gameState.foundations[foundationIndex];
            
            if (foundation.length === 0) {
                return card.rank === 1; // A
            } else {
                const topCard = foundation[foundation.length - 1];
                return card.rank === topCard.rank + 1;
            }
        }

        function showHint() {
            if (!gameState.gameActive) return;
            
            let hints = [];
            
            // Âü∫Á§éÊù≠„Å´ÁßªÂãï„Åß„Åç„Çã„Ç´„Éº„Éâ„ÇíÊé¢„Åô
            for (let i = 0; i < 7; i++) {
                const pile = gameState.tableau[i];
                if (pile.length > 0) {
                    const card = pile[pile.length - 1];
                    if (card.faceUp && canMoveToFoundation(card)) {
                        hints.push(`„Çø„Éñ„É≠„Éº${i + 1}„ÅÆ${card.value}${suitSymbols[card.suit]}„ÇíÂü∫Á§éÊù≠„Å´ÁßªÂãï„Åß„Åç„Åæ„Åô`);
                    }
                }
            }
            
            if (gameState.waste.length > 0) {
                const card = gameState.waste[gameState.waste.length - 1];
                if (canMoveToFoundation(card)) {
                    hints.push(`„ÇÅ„Åè„ÇäÊú≠„ÅÆ${card.value}${suitSymbols[card.suit]}„ÇíÂü∫Á§éÊù≠„Å´ÁßªÂãï„Åß„Åç„Åæ„Åô`);
                }
            }
            
            // Â±±Êú≠„Çí„ÇÅ„Åè„ÇãÊèêÊ°à
            if (hints.length === 0 && gameState.stock.length > 0) {
                hints.push('Â±±Êú≠„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„Çí„ÇÅ„Åè„Å£„Å¶„Åø„Åæ„Åó„Çá„ÅÜ');
            }
            
            if (hints.length === 0) {
                hints.push('ÁèæÂú®ÂÆüË°åÂèØËÉΩ„Å™ÊúÄÈÅ©„Å™Êâã„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÈÖçÁΩÆ„ÇíË¶ãÁõ¥„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ');
            }
            
            alert(`üí° „Éí„É≥„Éà:\n${hints.join('\n')}`);
        }

        function checkForWin() {
            const totalCards = gameState.foundations.reduce((sum, foundation) => sum + foundation.length, 0);
            
            if (totalCards === 52) {
                gameState.gameActive = false;
                gameState.gamesCompleted++;
                
                if (!gameState.bestMoves || gameState.moves < gameState.bestMoves) {
                    gameState.bestMoves = gameState.moves;
                }
                
                let message = `üèÜ „ÇΩ„É™„ÉÜ„Ç£„Ç¢ÂÆåÊàêÔºÅ\n\n`;
                message += `ÊâãÊï∞: ${gameState.moves}Êâã\n`;
                message += `ÂÆåÊàê„Ç≤„Éº„É†: ${gameState.gamesCompleted}/${gameState.totalGames}\n`;
                message += `ÂÆåÊàêÁéá: ${Math.round((gameState.gamesCompleted / gameState.gamesPlayed) * 100)}%\n\n`;
                
                if (gameState.gamesCompleted >= Math.ceil(gameState.totalGames * 0.8)) {
                    message += `üéØ „ÇØ„É™„Ç¢ÈÅîÊàêÔºÅ„ÇΩ„É™„ÉÜ„Ç£„Ç¢„Éû„Çπ„Çø„ÉºË™çÂÆöÔºÅ`;
                } else {
                    message += `ÁõÆÊ®ô: ${Math.ceil(gameState.totalGames * 0.8)}„Ç≤„Éº„É†ÂÆåÊàê„Åß80%ÈÅîÊàê`;
                }
                
                alert(message);
                
                if (gameState.gamesPlayed < gameState.totalGames) {
                    setTimeout(() => newGame(), 2000);
                }
            }
        }

        function restartGame() {
            if (gameState.retryCount >= gameState.maxRetries) {
                alert(`„ÇÑ„ÇäÁõ¥„ÅóÂõûÊï∞„ÅÆ‰∏äÈôê(${gameState.maxRetries}Âõû)„Å´ÈÅî„Åó„Åæ„Åó„Åü`);
                return;
            }
            
            gameState.retryCount++;
            dealCards();
            updateStats();
        }

        function updateStats() {
            document.getElementById('completedGames').textContent = `${gameState.gamesCompleted}/${gameState.totalGames}`;
            
            const completionRate = gameState.gamesPlayed > 0 ? 
                Math.round((gameState.gamesCompleted / gameState.gamesPlayed) * 100) : 0;
            document.getElementById('completionRate').textContent = `${completionRate}%`;
            
            document.getElementById('bestMoves').textContent = gameState.bestMoves || '--';
            document.getElementById('retryCount').textContent = `${gameState.retryCount}/${gameState.maxRetries}`;
            
            // „Ç≤„Éº„É†Áä∂Ê≥ÅÊõ¥Êñ∞
            let status = '';
            if (!gameState.gameActive && gameState.gamesPlayed === 0) {
                status = 'Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            } else if (gameState.gameActive) {
                status = `„Ç≤„Éº„É†ÈÄ≤Ë°å‰∏≠ - ÊâãÊï∞: ${gameState.moves}`;
            } else {
                status = `„Ç≤„Éº„É†${gameState.gamesPlayed}ÂÆå‰∫Ü - Ê¨°„ÅÆ„Ç≤„Éº„É†„Å∏`;
            }
            
            document.getElementById('gameStatus').textContent = status;
        }

        function updateButtons() {
            const restartBtn = document.getElementById('restartBtn');
            restartBtn.disabled = !gameState.gameActive || gameState.retryCount >= gameState.maxRetries;
        }

        function newGame() {
            gameState.gamesPlayed++;
            gameState.retryCount = 0;
            dealCards();
        }

        // „Ç≤„Éº„É†ÂàùÊúüÂåñ
        updateStats();
    </script>
</body>
</html>