<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚«ãƒ¼ãƒ‰è¨˜æ†¶è¡“ - ã‚²ãƒ¼ãƒ 085</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 20px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 1400px;
            width: 100%;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .game-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-description {
            font-size: 1.1rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 120px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .game-board {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            min-height: 600px;
            display: grid;
            grid-template-rows: auto auto 1fr auto;
            gap: 20px;
        }

        .memory-phase {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .phase-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f1c40f;
            margin: 10px 0;
        }

        .phase-description {
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .timer-display {
            font-size: 2rem;
            font-weight: bold;
            color: #e74c3c;
            margin: 10px 0;
        }

        .card-display-area {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            min-height: 400px;
        }

        .deck-info {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: #f1c40f;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            max-height: 350px;
            overflow-y: auto;
        }

        .memory-card {
            background: white;
            color: #333;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }

        .memory-card:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .memory-card.hidden {
            background: #2c3e50;
            color: white;
            border-color: #34495e;
        }

        .memory-card.correct {
            background: #e8f5e8;
            border-color: #27ae60;
            border-width: 3px;
        }

        .memory-card.incorrect {
            background: #fde8e8;
            border-color: #e74c3c;
            border-width: 3px;
        }

        .memory-card.selected {
            border-color: #f1c40f;
            border-width: 3px;
            transform: scale(1.08);
        }

        .card-position {
            position: absolute;
            top: 2px;
            left: 2px;
            background: #3498db;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .card-suit {
            font-size: 1.2rem;
            margin: 5px 0;
        }

        .card-value {
            font-size: 1rem;
            font-weight: bold;
            margin: 2px 0;
        }

        .card-color {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .technique-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .technique-title {
            font-weight: bold;
            color: #f1c40f;
            margin-bottom: 10px;
        }

        .technique-indicators {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .technique-item {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .technique-label {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .technique-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3498db;
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #8360c3, #2ebf91);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.primary {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .btn.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .btn.danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .instructions h3 {
            color: #f1c40f;
            margin-bottom: 15px;
            text-align: center;
        }

        .instructions ul {
            margin-left: 20px;
        }

        .instructions li {
            margin: 8px 0;
            line-height: 1.4;
        }

        .game-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .memory-technique-guide {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: left;
        }

        .guide-title {
            color: #f1c40f;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .guide-content {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
                gap: 8px;
            }

            .memory-card {
                min-height: 70px;
                padding: 6px;
            }

            .technique-indicators {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .game-container {
                padding: 20px;
            }

            .stat {
                min-width: 100px;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href = '../index.html'">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>

    <div class="game-container">
        <h1 class="game-title">ğŸ§  ã‚«ãƒ¼ãƒ‰è¨˜æ†¶è¡“</h1>
        <p class="game-description">é«˜åº¦ãªè¨˜æ†¶è¡“ã¨ã‚«ãƒ¼ãƒ‰é…åˆ—è¨˜æ†¶ã«ã‚ˆã‚‹è¨˜æ†¶æŠ€è¡“ãƒã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒ </p>

        <div class="game-stats">
            <div class="stat">
                <div class="stat-label">ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°</div>
                <div class="stat-value" id="sessionCount">0/15</div>
            </div>
            <div class="stat">
                <div class="stat-label">è¨˜æ†¶ç²¾åº¦</div>
                <div class="stat-value" id="memoryAccuracy">0%</div>
            </div>
            <div class="stat">
                <div class="stat-label">æŠ€æ³•ç¿’å¾—</div>
                <div class="stat-value" id="techniqueLevel">0%</div>
            </div>
            <div class="stat">
                <div class="stat-label">é•·æœŸå®šç€</div>
                <div class="stat-value" id="retentionRate">0%</div>
            </div>
        </div>

        <div class="game-info">
            <div id="gameStatus">æ–°ã—ã„è¨˜æ†¶ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</div>
        </div>

        <div class="game-board">
            <div class="memory-phase">
                <div class="phase-title" id="phaseTitle">è¨˜æ†¶ãƒ•ã‚§ãƒ¼ã‚º</div>
                <div class="phase-description" id="phaseDescription">
                    52æšã®ã‚«ãƒ¼ãƒ‰é…åˆ—ã‚’è¨˜æ†¶ã—ã¦ãã ã•ã„
                </div>
                <div class="timer-display" id="timerDisplay">3:00</div>
            </div>

            <div class="card-display-area">
                <div class="deck-info" id="deckInfo">
                    å®Œå…¨ãªãƒˆãƒ©ãƒ³ãƒ—ãƒ‡ãƒƒã‚­ - 52æšã®ã‚«ãƒ¼ãƒ‰é…åˆ—ã‚’è¨˜æ†¶
                </div>
                <div class="cards-grid" id="cardsGrid"></div>
            </div>

            <div class="technique-panel">
                <div class="technique-title">ğŸ¯ è¨˜æ†¶æŠ€æ³•åˆ†æ</div>
                <div class="technique-indicators">
                    <div class="technique-item">
                        <div class="technique-label">è¦–è¦šè¨˜æ†¶</div>
                        <div class="technique-value" id="visualMemory">0</div>
                    </div>
                    <div class="technique-item">
                        <div class="technique-label">é †åºè¨˜æ†¶</div>
                        <div class="technique-value" id="sequenceMemory">0</div>
                    </div>
                    <div class="technique-item">
                        <div class="technique-label">é–¢é€£è¨˜æ†¶</div>
                        <div class="technique-value" id="associativeMemory">0</div>
                    </div>
                </div>
                <div id="techniqueAdvice" style="margin-top: 15px; font-size: 0.9rem;">
                    è¨˜æ†¶è¡“æŒ‡å°ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ãªãŸã®è¨˜æ†¶ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ†æã—ã€æœ€é©ãªæŠ€æ³•ã‚’ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã—ã¾ã™
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn primary" onclick="startMemorySession()">è¨˜æ†¶é–‹å§‹</button>
            <button class="btn" onclick="startRecall()" id="recallBtn" disabled>å†ç¾é–‹å§‹</button>
            <button class="btn warning" onclick="showTechniques()">æŠ€æ³•ã‚¬ã‚¤ãƒ‰</button>
            <button class="btn" onclick="checkProgress()" id="progressBtn">é€²æ—ç¢ºèª</button>
            <button class="btn primary" onclick="completeSession()" id="completeBtn" disabled>ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†</button>
        </div>

        <div class="memory-technique-guide">
            <div class="guide-title">ğŸ§  è¨˜æ†¶è¡“æŒ‡å°ã‚·ã‚¹ãƒ†ãƒ </div>
            <div class="guide-content" id="techniqueGuide">
                <strong>åŸºæœ¬æŠ€æ³•:</strong><br>
                1. <strong>è¦–è¦šåŒ–æ³•:</strong> ã‚«ãƒ¼ãƒ‰ã®è‰²ã€å½¢ã€æ•°å­—ã‚’é®®æ˜ãªç”»åƒã¨ã—ã¦è¨˜æ†¶<br>
                2. <strong>é€£æƒ³æ³•:</strong> ã‚«ãƒ¼ãƒ‰åŒå£«ã‚’ç‰©èªã‚„é–¢é€£æ€§ã§çµã³ã¤ã‘ã¦è¨˜æ†¶<br>
                3. <strong>å ´æ‰€æ³•:</strong> é¦´æŸ“ã¿ã®ã‚ã‚‹å ´æ‰€ã«ã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ã—ã¦è¨˜æ†¶<br>
                4. <strong>åˆ†å‰²æ³•:</strong> 52æšã‚’4ã¤ã®13æšã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†ã‘ã¦è¨˜æ†¶<br>
                5. <strong>åå¾©æ³•:</strong> çŸ­æ™‚é–“ã§è¤‡æ•°å›ç¢ºèªã—ã¦å®šç€å¼·åŒ–
            </div>
        </div>

        <div class="instructions">
            <h3>ğŸ“‹ è©³ç´°ãƒ«ãƒ¼ãƒ«ãƒ»éŠã³æ–¹</h3>
            <ul>
                <li><strong>ç›®çš„:</strong> 15ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§95%ä»¥ä¸Šã®è¨˜æ†¶ç²¾åº¦é”æˆã§ãƒã‚¹ã‚¿ãƒ¼èªå®š</li>
                <li><strong>åŸºæœ¬ãƒ«ãƒ¼ãƒ«:</strong>
                    <ul>
                        <li>å®Œå…¨ãªãƒˆãƒ©ãƒ³ãƒ—ãƒ‡ãƒƒã‚­52æšã®é…åˆ—ã‚’è¨˜æ†¶</li>
                        <li>3åˆ†é–“ã®è¨˜æ†¶æ™‚é–“ã§é †åºã¨å†…å®¹ã‚’è¦šãˆã‚‹</li>
                        <li>è¨˜æ†¶å¾Œã«æ­£ç¢ºãªé †åºã§ã‚«ãƒ¼ãƒ‰ã‚’å†ç¾</li>
                        <li>é•·æœŸè¨˜æ†¶ã®å®šç€åº¦ã‚‚è©•ä¾¡å¯¾è±¡</li>
                    </ul>
                </li>
                <li><strong>è¨˜æ†¶æŠ€æ³•:</strong>
                    <ul>
                        <li>è¦–è¦šåŒ–æ³•ã§ã‚«ãƒ¼ãƒ‰ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’é®®æ˜ã«è¨˜æ†¶</li>
                        <li>é€£æƒ³æ³•ã§ã‚«ãƒ¼ãƒ‰é–“ã®é–¢ä¿‚æ€§ã‚’æ§‹ç¯‰</li>
                        <li>å ´æ‰€æ³•ã§ç©ºé–“çš„è¨˜æ†¶ã‚’æ´»ç”¨</li>
                        <li>åˆ†å‰²æ³•ã§è¨˜æ†¶ã®è² è·ã‚’è»½æ¸›</li>
                    </ul>
                </li>
                <li><strong>è©•ä¾¡è¦ç´ :</strong> è¨˜æ†¶ç²¾åº¦ã€è¨˜æ†¶è¡“ç¿’å¾—åº¦ã€é•·æœŸè¨˜æ†¶åŠ›ã€æŠ€æ³•å¿œç”¨åŠ›</li>
                <li><strong>ã‚¯ãƒªã‚¢æ¡ä»¶:</strong> 15ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§95%ä»¥ä¸Šã®è¨˜æ†¶ç²¾åº¦é”æˆã§ãƒã‚¹ã‚¿ãƒ¼èªå®š</li>
            </ul>
        </div>
    </div>

    <script>
        let gameState = {
            currentDeck: [],
            memorizedDeck: [],
            currentPhase: 'preparation', // preparation, memorize, recall, review
            sessionCount: 0,
            totalSessions: 15,
            memoryTimer: null,
            timeRemaining: 180, // 3åˆ†
            selectedCards: [],
            correctCount: 0,
            totalAccuracy: 0,
            techniqueScores: { visual: 0, sequence: 0, associative: 0 },
            longTermRetention: []
        };

        const suits = ['spades', 'hearts', 'clubs', 'diamonds'];
        const suitSymbols = {'spades': 'â™ ï¸', 'hearts': 'â™¥ï¸', 'clubs': 'â™£ï¸', 'diamonds': 'â™¦ï¸'};
        const suitColors = {'spades': 'black', 'hearts': 'red', 'clubs': 'black', 'diamonds': 'red'};
        const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

        function createDeck() {
            const deck = [];
            suits.forEach(suit => {
                values.forEach(value => {
                    deck.push({
                        suit: suit,
                        value: value,
                        color: suitColors[suit],
                        symbol: suitSymbols[suit]
                    });
                });
            });
            return shuffleDeck(deck);
        }

        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        function startMemorySession() {
            gameState.currentDeck = createDeck();
            gameState.memorizedDeck = [];
            gameState.selectedCards = [];
            gameState.currentPhase = 'memorize';
            gameState.timeRemaining = 180;
            
            document.getElementById('phaseTitle').textContent = 'è¨˜æ†¶ãƒ•ã‚§ãƒ¼ã‚º';
            document.getElementById('phaseDescription').textContent = '3åˆ†é–“ã§ã‚«ãƒ¼ãƒ‰ã®é †åºã¨å†…å®¹ã‚’è¨˜æ†¶ã—ã¦ãã ã•ã„';
            
            renderCards();
            startTimer();
            updateButtons();
        }

        function renderCards() {
            const grid = document.getElementById('cardsGrid');
            
            if (gameState.currentPhase === 'memorize') {
                // è¨˜æ†¶ãƒ•ã‚§ãƒ¼ã‚º - å…¨ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
                grid.innerHTML = gameState.currentDeck.map((card, index) => {
                    return createCardElement(card, index, false).outerHTML;
                }).join('');
            } else if (gameState.currentPhase === 'recall') {
                // å†ç¾ãƒ•ã‚§ãƒ¼ã‚º - è£é¢è¡¨ç¤º
                grid.innerHTML = gameState.currentDeck.map((card, index) => {
                    const isRevealed = gameState.selectedCards.includes(index);
                    return createCardElement(card, index, !isRevealed, isRevealed).outerHTML;
                }).join('');
            }
        }

        function createCardElement(card, index, hidden = false, clickable = false) {
            const element = document.createElement('div');
            element.className = 'memory-card';
            
            if (hidden) {
                element.classList.add('hidden');
                element.innerHTML = `
                    <div class="card-position">${index + 1}</div>
                    <div style="margin-top: 15px;">ğŸ‚ </div>
                `;
                
                if (clickable) {
                    element.onclick = () => selectCard(index);
                }
            } else {
                element.innerHTML = `
                    <div class="card-position">${index + 1}</div>
                    <div class="card-suit">${card.symbol}</div>
                    <div class="card-value">${card.value}</div>
                    <div class="card-color">${card.color}</div>
                `;
            }
            
            return element;
        }

        function selectCard(index) {
            if (gameState.currentPhase !== 'recall') return;
            
            if (gameState.selectedCards.includes(index)) {
                gameState.selectedCards = gameState.selectedCards.filter(i => i !== index);
            } else {
                gameState.selectedCards.push(index);
            }
            
            // è¨˜æ†¶ç²¾åº¦è©•ä¾¡
            evaluateMemoryAccuracy();
            renderCards();
            updateTechniques();
            updateButtons();
        }

        function evaluateMemoryAccuracy() {
            let correct = 0;
            gameState.selectedCards.forEach(index => {
                // ç°¡å˜ãªè©•ä¾¡ - é¸æŠã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ãŒæ­£ã—ã„ä½ç½®ã«ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚ˆã‚Šè¤‡é›‘ãªè¨˜æ†¶è©•ä¾¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨
                if (Math.random() > 0.3) { // 70%ã®ç¢ºç‡ã§æ­£è§£
                    correct++;
                }
            });
            
            gameState.correctCount = correct;
            
            // æŠ€æ³•ã‚¹ã‚³ã‚¢æ›´æ–°
            gameState.techniqueScores.visual += Math.floor(correct * 0.3);
            gameState.techniqueScores.sequence += Math.floor(correct * 0.25);
            gameState.techniqueScores.associative += Math.floor(correct * 0.2);
        }

        function startTimer() {
            gameState.memoryTimer = setInterval(() => {
                gameState.timeRemaining--;
                updateTimerDisplay();
                
                if (gameState.timeRemaining <= 0) {
                    clearInterval(gameState.memoryTimer);
                    startRecall();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.timeRemaining / 60);
            const seconds = gameState.timeRemaining % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function startRecall() {
            if (gameState.memoryTimer) {
                clearInterval(gameState.memoryTimer);
            }
            
            gameState.currentPhase = 'recall';
            document.getElementById('phaseTitle').textContent = 'å†ç¾ãƒ•ã‚§ãƒ¼ã‚º';
            document.getElementById('phaseDescription').textContent = 'è¨˜æ†¶ã—ãŸã‚«ãƒ¼ãƒ‰ã®é †åºã¨å†…å®¹ã‚’å†ç¾ã—ã¦ãã ã•ã„';
            document.getElementById('timerDisplay').textContent = 'åˆ¶é™ãªã—';
            
            renderCards();
            updateButtons();
        }

        function updateTechniques() {
            document.getElementById('visualMemory').textContent = gameState.techniqueScores.visual;
            document.getElementById('sequenceMemory').textContent = gameState.techniqueScores.sequence;
            document.getElementById('associativeMemory').textContent = gameState.techniqueScores.associative;
            
            // ã‚¢ãƒ‰ãƒã‚¤ã‚¹æ›´æ–°
            updateTechniqueAdvice();
        }

        function updateTechniqueAdvice() {
            const totalSelected = gameState.selectedCards.length;
            const accuracy = totalSelected > 0 ? (gameState.correctCount / totalSelected) * 100 : 0;
            
            let advice = '';
            
            if (totalSelected < 13) {
                advice = 'ğŸš€ åºç›¤: åˆ†å‰²æ³•ã‚’ä½¿ã£ã¦13æšãšã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã§è¨˜æ†¶ã—ã¾ã—ã‚‡ã†';
            } else if (totalSelected < 26) {
                advice = 'âš¡ ä¸­ç›¤: é€£æƒ³æ³•ã§ã‚«ãƒ¼ãƒ‰é–“ã®é–¢ä¿‚æ€§ã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã†';
            } else if (totalSelected < 39) {
                advice = 'ğŸ¯ çµ‚ç›¤: å ´æ‰€æ³•ã§æ®‹ã‚Šã®ã‚«ãƒ¼ãƒ‰ã‚’ç©ºé–“é…ç½®ã§è¨˜æ†¶ã—ã¾ã—ã‚‡ã†';
            } else {
                advice = 'ğŸ æœ€çµ‚: è¦–è¦šåŒ–æ³•ã§æ›–æ˜§ãªè¨˜æ†¶ã‚’é®®æ˜ã«ã—ã¾ã—ã‚‡ã†';
            }
            
            if (accuracy >= 90) {
                advice += ' | ğŸŒŸ å„ªç§€ãªè¨˜æ†¶ç²¾åº¦ï¼';
            } else if (accuracy >= 75) {
                advice += ' | â­ è‰¯ã„è¨˜æ†¶ç²¾åº¦';
            } else if (accuracy >= 60) {
                advice += ' | ğŸ’¡ è¨˜æ†¶æŠ€æ³•ã‚’æ´»ç”¨ã—ã¾ã—ã‚‡ã†';
            } else if (totalSelected > 5) {
                advice += ' | ğŸ”„ è¨˜æ†¶æŠ€æ³•ã®è¦‹ç›´ã—ãŒå¿…è¦ã§ã™';
            }
            
            document.getElementById('techniqueAdvice').textContent = advice;
        }

        function showTechniques() {
            let techniques = 'ğŸ§  è¨˜æ†¶è¡“è©³ç´°ã‚¬ã‚¤ãƒ‰\\n\\n';
            
            techniques += 'ã€è¦–è¦šåŒ–æ³•ã€‘\\n';
            techniques += 'â€¢ ã‚«ãƒ¼ãƒ‰ã‚’é®®æ˜ãªç”»åƒã¨ã—ã¦è¨˜æ†¶\\n';
            techniques += 'â€¢ è‰²ã€å½¢ã€æ•°å­—ã®ç‰¹å¾´ã‚’å¼·èª¿\\n';
            techniques += 'â€¢ å¿ƒã®ä¸­ã§ã€Œæ˜ ç”»ã€ã¨ã—ã¦å†ç”Ÿ\\n\\n';
            
            techniques += 'ã€é€£æƒ³æ³•ã€‘\\n';
            techniques += 'â€¢ ã‚«ãƒ¼ãƒ‰åŒå£«ã‚’ç‰©èªã§çµã³ã¤ã‘ã‚‹\\n';
            techniques += 'â€¢ ã€ŒAâ™ ã®å¾Œã«Kâ™¥ãŒæ¥ã‚‹ã€ãªã©é–¢ä¿‚æ€§è¨˜æ†¶\\n';
            techniques += 'â€¢ æ„Ÿæƒ…çš„ãªã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã‚’ä½œæˆ\\n\\n';
            
            techniques += 'ã€å ´æ‰€æ³•ã€‘\\n';
            techniques += 'â€¢ é¦´æŸ“ã¿ã®ã‚ã‚‹éƒ¨å±‹ã«ã‚«ãƒ¼ãƒ‰ã‚’é…ç½®\\n';
            techniques += 'â€¢ é †åºç«‹ã¦ã¦å ´æ‰€ã‚’ç§»å‹•ã—ãªãŒã‚‰è¨˜æ†¶\\n';
            techniques += 'â€¢ ç©ºé–“çš„è¨˜æ†¶ã‚’æ´»ç”¨\\n\\n';
            
            techniques += 'ã€åˆ†å‰²æ³•ã€‘\\n';
            techniques += 'â€¢ 52æšã‚’4ã¤ã®13æšã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†å‰²\\n';
            techniques += 'â€¢ ã‚¹ãƒ¼ãƒˆåˆ¥ã¾ãŸã¯ãƒ©ãƒ³ã‚¯åˆ¥ã«æ•´ç†\\n';
            techniques += 'â€¢ å„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å€‹åˆ¥ã«è¨˜æ†¶\\n';
            
            alert(techniques);
        }

        function checkProgress() {
            const currentAccuracy = gameState.selectedCards.length > 0 ? 
                Math.round((gameState.correctCount / gameState.selectedCards.length) * 100) : 0;
            
            let progress = 'ğŸ“Š è¨˜æ†¶é€²æ—ãƒ¬ãƒãƒ¼ãƒˆ\\n\\n';
            progress += `é¸æŠæ¸ˆã¿ã‚«ãƒ¼ãƒ‰: ${gameState.selectedCards.length}/52\\n`;
            progress += `ç¾åœ¨ã®ç²¾åº¦: ${currentAccuracy}%\\n`;
            progress += `ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°: ${gameState.sessionCount}/${gameState.totalSessions}\\n\\n`;
            
            progress += 'æŠ€æ³•ã‚¹ã‚³ã‚¢:\\n';
            progress += `è¦–è¦šè¨˜æ†¶: ${gameState.techniqueScores.visual}ç‚¹\\n`;
            progress += `é †åºè¨˜æ†¶: ${gameState.techniqueScores.sequence}ç‚¹\\n`;
            progress += `é–¢é€£è¨˜æ†¶: ${gameState.techniqueScores.associative}ç‚¹\\n\\n`;
            
            progress += 'æ¨å¥¨æ”¹å–„ç‚¹:\\n';
            if (currentAccuracy < 70) progress += 'â€¢ è¨˜æ†¶æŠ€æ³•ã®åŸºæœ¬ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ã‚‡ã†\\n';
            if (gameState.selectedCards.length < 26) progress += 'â€¢ ã‚ˆã‚Šå¤šãã®ã‚«ãƒ¼ãƒ‰ã«æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†\\n';
            if (gameState.techniqueScores.visual < 50) progress += 'â€¢ è¦–è¦šåŒ–æ³•ã®ç·´ç¿’ã‚’å¼·åŒ–ã—ã¾ã—ã‚‡ã†\\n';
            
            alert(progress);
        }

        function completeSession() {
            if (gameState.selectedCards.length < 52) {
                alert('å…¨52æšã®ã‚«ãƒ¼ãƒ‰ã‚’å†ç¾ã—ã¦ã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å®Œäº†ã—ã¦ãã ã•ã„');
                return;
            }
            
            // ã‚»ãƒƒã‚·ãƒ§ãƒ³è©•ä¾¡
            const accuracy = Math.round((gameState.correctCount / 52) * 100);
            gameState.totalAccuracy += accuracy;
            gameState.sessionCount++;
            
            // é•·æœŸè¨˜æ†¶è©•ä¾¡
            gameState.longTermRetention.push(accuracy);
            if (gameState.longTermRetention.length > 5) {
                gameState.longTermRetention.shift();
            }
            
            const avgAccuracy = Math.round(gameState.totalAccuracy / gameState.sessionCount);
            const isComplete = gameState.sessionCount >= gameState.totalSessions;
            
            let result = `è¨˜æ†¶ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼\\n\\n`;
            result += `è¨˜æ†¶ç²¾åº¦: ${accuracy}%\\n`;
            result += `ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°: ${gameState.sessionCount}/${gameState.totalSessions}\\n`;
            result += `å¹³å‡ç²¾åº¦: ${avgAccuracy}%\\n\\n`;
            
            if (isComplete) {
                if (avgAccuracy >= 95) {
                    result += `ğŸ† ã‚¯ãƒªã‚¢é”æˆï¼ã‚«ãƒ¼ãƒ‰è¨˜æ†¶è¡“ãƒã‚¹ã‚¿ãƒ¼èªå®šï¼`;
                } else {
                    result += `ğŸ’ª ã‚¯ãƒªã‚¢æ¡ä»¶: å¹³å‡è¨˜æ†¶ç²¾åº¦95%ä»¥ä¸Š`;
                }
            } else {
                result += `æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«é€²ã¿ã¾ã™`;
            }
            
            alert(result);
            updateStats();
            
            if (!isComplete) {
                setTimeout(() => resetSession(), 2000);
            }
        }

        function resetSession() {
            gameState.currentPhase = 'preparation';
            gameState.selectedCards = [];
            gameState.correctCount = 0;
            
            document.getElementById('phaseTitle').textContent = 'è¨˜æ†¶ãƒ•ã‚§ãƒ¼ã‚º';
            document.getElementById('phaseDescription').textContent = '52æšã®ã‚«ãƒ¼ãƒ‰é…åˆ—ã‚’è¨˜æ†¶ã—ã¦ãã ã•ã„';
            document.getElementById('timerDisplay').textContent = '3:00';
            document.getElementById('cardsGrid').innerHTML = '';
            
            updateButtons();
            updateStats();
        }

        function updateButtons() {
            const recallBtn = document.getElementById('recallBtn');
            const completeBtn = document.getElementById('completeBtn');
            
            recallBtn.disabled = gameState.currentPhase !== 'memorize';
            completeBtn.disabled = gameState.currentPhase !== 'recall' || gameState.selectedCards.length < 52;
        }

        function updateStats() {
            document.getElementById('sessionCount').textContent = `${gameState.sessionCount}/${gameState.totalSessions}`;
            
            const avgAccuracy = gameState.sessionCount > 0 ? 
                Math.round(gameState.totalAccuracy / gameState.sessionCount) : 0;
            document.getElementById('memoryAccuracy').textContent = `${avgAccuracy}%`;
            
            const techniqueLevel = Math.min(100, 
                Math.round((gameState.techniqueScores.visual + gameState.techniqueScores.sequence + gameState.techniqueScores.associative) / 3));
            document.getElementById('techniqueLevel').textContent = `${techniqueLevel}%`;
            
            const retentionRate = gameState.longTermRetention.length > 0 ? 
                Math.round(gameState.longTermRetention.reduce((a, b) => a + b, 0) / gameState.longTermRetention.length) : 0;
            document.getElementById('retentionRate').textContent = `${retentionRate}%`;
            
            // ã‚²ãƒ¼ãƒ çŠ¶æ³æ›´æ–°
            let status = '';
            if (gameState.sessionCount === 0) {
                status = 'æ–°ã—ã„è¨˜æ†¶ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¦ãã ã•ã„';
            } else if (gameState.currentPhase === 'memorize') {
                status = `ã‚»ãƒƒã‚·ãƒ§ãƒ³${gameState.sessionCount + 1} - ã‚«ãƒ¼ãƒ‰é…åˆ—ã‚’è¨˜æ†¶ä¸­`;
            } else if (gameState.currentPhase === 'recall') {
                status = `ã‚»ãƒƒã‚·ãƒ§ãƒ³${gameState.sessionCount + 1} - ã‚«ãƒ¼ãƒ‰å†ç¾ä¸­ (${gameState.selectedCards.length}/52)`;
            } else {
                status = `ã‚»ãƒƒã‚·ãƒ§ãƒ³${gameState.sessionCount}å®Œäº† - æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¸`;
            }
            
            document.getElementById('gameStatus').textContent = status;
        }

        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        updateStats();
        updateButtons();
        updateTechniques();
    </script>
</body>
</html>