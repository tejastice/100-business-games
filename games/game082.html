<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ãƒ”ãƒ¼ãƒ‰ - ã‚²ãƒ¼ãƒ 082</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #2c5530 0%, #1a472a 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        .game-title {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-description {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 15px;
            min-width: 100px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .card-table {
            background: #2c5530;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            min-height: 300px;
            border: 3px solid #4caf50;
        }

        .cards-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 200px;
        }

        .card {
            width: 120px;
            height: 160px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            border: 3px solid #ddd;
            position: relative;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .card.red {
            color: #d32f2f;
        }

        .card.black {
            color: #333;
        }

        .card.selected {
            border-color: #ffeb3b;
            box-shadow: 0 0 20px #ffeb3b;
        }

        .vs-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .vs-text {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffeb3b;
        }

        .instruction {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .reaction-time {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .result-display {
            margin-top: 20px;
            font-size: 1.3rem;
            font-weight: bold;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-correct {
            color: #4caf50;
        }

        .result-incorrect {
            color: #f44336;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .game-over {
            display: none;
            background: rgba(76, 175, 80, 0.2);
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
            border: 2px solid #4caf50;
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: left;
        }

        .streak-display {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 235, 59, 0.2);
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
            border: 1px solid #ffeb3b;
        }

        .streak-bonus {
            color: #ffeb3b;
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .cards-container {
                flex-direction: column;
                gap: 20px;
                height: auto;
            }
            
            .card {
                width: 100px;
                height: 130px;
                font-size: 2.5rem;
            }
            
            .vs-section {
                margin: 20px 0;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="goBack()">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>

    <div class="game-container">
        <h1 class="game-title">ğŸƒ ã‚¹ãƒ”ãƒ¼ãƒ‰</h1>
        <p class="game-description">2æšã®ã‚«ãƒ¼ãƒ‰ã‚’ç´ æ—©ãæ¯”è¼ƒã—ã¦ã€å¤§ãã„æ•°å­—ã‚’é¸æŠã—ã‚ˆã†ï¼</p>

        <div class="game-stats">
            <div class="stat">
                <div class="stat-label">ã‚¹ã‚³ã‚¢</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">æ­£è§£æ•°</div>
                <div class="stat-value" id="correct">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">é€£ç¶šæ­£è§£</div>
                <div class="stat-value" id="streak">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">æ®‹ã‚Šæ™‚é–“</div>
                <div class="stat-value" id="timeLeft">60</div>
            </div>
        </div>

        <div class="card-table">
            <div class="streak-display" id="streakDisplay" style="display: none;">
                <span class="streak-bonus">ğŸ”¥ é€£ç¶šãƒœãƒ¼ãƒŠã‚¹!</span>
            </div>

            <div class="cards-container">
                <div class="card" id="leftCard" onclick="selectCard('left')">
                    <span id="leftCardValue">A</span>
                </div>

                <div class="vs-section">
                    <div class="vs-text">VS</div>
                    <div class="instruction" id="instruction">
                        ã‚ˆã‚Šå¤§ãã„æ•°å­—ã®ã‚«ãƒ¼ãƒ‰ã‚’<br>ã‚¯ãƒªãƒƒã‚¯ã—ã‚ˆã†ï¼
                    </div>
                    <div class="reaction-time" id="reactionTime">
                        åå¿œæ™‚é–“: 0ms
                    </div>
                </div>

                <div class="card" id="rightCard" onclick="selectCard('right')">
                    <span id="rightCardValue">K</span>
                </div>
            </div>

            <div class="result-display" id="resultDisplay"></div>
        </div>

        <div class="controls">
            <button class="btn" id="startBtn" onclick="startGame()">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
            <button class="btn" onclick="pauseGame()">ä¸€æ™‚åœæ­¢</button>
            <button class="btn" onclick="resetGame()">ãƒªã‚»ãƒƒãƒˆ</button>
            <button class="btn" onclick="goBack()">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
        </div>

        <div class="game-over" id="gameOver">
            <h2>ğŸ‰ ã‚²ãƒ¼ãƒ çµ‚äº†ï¼</h2>
            <p>æœ€çµ‚ã‚¹ã‚³ã‚¢: <span id="finalScore">0</span></p>
            <p>æ­£è§£ç‡: <span id="accuracy">0%</span></p>
            <p>æœ€é«˜é€£ç¶šæ­£è§£: <span id="maxStreak">0</span></p>
            <p>å¹³å‡åå¿œæ™‚é–“: <span id="avgReactionTime">0ms</span></p>
        </div>

        <div class="instructions">
            <h3>ğŸ¯ éŠã³æ–¹</h3>
            <p>â€¢ 2æšã®ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
            <p>â€¢ ã‚ˆã‚Šå¤§ãã„æ•°å­—ã®ã‚«ãƒ¼ãƒ‰ã‚’ç´ æ—©ãã‚¯ãƒªãƒƒã‚¯</p>
            <p>â€¢ A=1, J=11, Q=12, K=13ã¨ã—ã¦è¨ˆç®—</p>
            <p>â€¢ é€£ç¶šæ­£è§£ã§ãƒœãƒ¼ãƒŠã‚¹ãƒã‚¤ãƒ³ãƒˆç²å¾—</p>
            <p>â€¢ åå¿œé€Ÿåº¦ãŒæ—©ã„ã»ã©é«˜ã‚¹ã‚³ã‚¢</p>
        </div>
    </div>

    <script>
        let gameState = {
            isPlaying: false,
            isPaused: false,
            score: 0,
            correct: 0,
            total: 0,
            streak: 0,
            maxStreak: 0,
            timeLeft: 60,
            gameTimer: null,
            currentRound: {
                leftValue: 0,
                rightValue: 0,
                startTime: 0
            },
            reactionTimes: []
        };

        const cardValues = {
            'A': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9, '10': 10, 'J': 11, 'Q': 12, 'K': 13
        };

        const cards = Object.keys(cardValues);

        function startGame() {
            if (gameState.isPlaying && !gameState.isPaused) return;

            if (gameState.isPaused) {
                // ä¸€æ™‚åœæ­¢ã‹ã‚‰å†é–‹
                gameState.isPaused = false;
                gameState.gameTimer = setInterval(updateTimer, 1000);
                return;
            }

            // æ–°ã—ã„ã‚²ãƒ¼ãƒ é–‹å§‹
            gameState = {
                isPlaying: true,
                isPaused: false,
                score: 0,
                correct: 0,
                total: 0,
                streak: 0,
                maxStreak: 0,
                timeLeft: 60,
                gameTimer: null,
                currentRound: {
                    leftValue: 0,
                    rightValue: 0,
                    startTime: 0
                },
                reactionTimes: []
            };

            document.getElementById('startBtn').textContent = 'å†é–‹';
            document.getElementById('gameOver').style.display = 'none';

            gameState.gameTimer = setInterval(updateTimer, 1000);
            generateNewCards();
            updateDisplay();
        }

        function pauseGame() {
            if (!gameState.isPlaying || gameState.isPaused) return;

            gameState.isPaused = true;
            clearInterval(gameState.gameTimer);
            document.getElementById('startBtn').textContent = 'å†é–‹';
            document.getElementById('instruction').innerHTML = 'ã‚²ãƒ¼ãƒ ä¸€æ™‚åœæ­¢ä¸­<br>å†é–‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„';
        }

        function generateNewCards() {
            if (!gameState.isPlaying || gameState.isPaused) return;

            let leftCard, rightCard;
            
            // åŒã˜ã‚«ãƒ¼ãƒ‰ãŒå‡ºãªã„ã‚ˆã†ã«ã™ã‚‹
            do {
                leftCard = cards[Math.floor(Math.random() * cards.length)];
                rightCard = cards[Math.floor(Math.random() * cards.length)];
            } while (cardValues[leftCard] === cardValues[rightCard]);

            gameState.currentRound.leftValue = cardValues[leftCard];
            gameState.currentRound.rightValue = cardValues[rightCard];
            gameState.currentRound.startTime = Date.now();

            // ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
            document.getElementById('leftCardValue').textContent = leftCard;
            document.getElementById('rightCardValue').textContent = rightCard;

            // ã‚«ãƒ¼ãƒ‰ã®è‰²è¨­å®šï¼ˆã‚¹ãƒšãƒ¼ãƒ‰ãƒ»ã‚¯ãƒ©ãƒ–=é»’ã€ãƒãƒ¼ãƒˆãƒ»ãƒ€ã‚¤ãƒ¤=èµ¤ï¼‰
            const leftCardElement = document.getElementById('leftCard');
            const rightCardElement = document.getElementById('rightCard');
            
            leftCardElement.className = 'card ' + (Math.random() > 0.5 ? 'red' : 'black');
            rightCardElement.className = 'card ' + (Math.random() > 0.5 ? 'red' : 'black');

            // é¸æŠçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            leftCardElement.classList.remove('selected');
            rightCardElement.classList.remove('selected');

            // æŒ‡ç¤ºã‚’æ›´æ–°
            document.getElementById('instruction').innerHTML = 'ã‚ˆã‚Šå¤§ãã„æ•°å­—ã®ã‚«ãƒ¼ãƒ‰ã‚’<br>ã‚¯ãƒªãƒƒã‚¯ã—ã‚ˆã†ï¼';
            document.getElementById('resultDisplay').textContent = '';
        }

        function selectCard(side) {
            if (!gameState.isPlaying || gameState.isPaused) return;

            const reactionTime = Date.now() - gameState.currentRound.startTime;
            gameState.reactionTimes.push(reactionTime);

            const selectedValue = side === 'left' ? gameState.currentRound.leftValue : gameState.currentRound.rightValue;
            const otherValue = side === 'left' ? gameState.currentRound.rightValue : gameState.currentRound.leftValue;
            const isCorrect = selectedValue > otherValue;

            gameState.total++;

            // é¸æŠã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            const selectedCard = document.getElementById(side + 'Card');
            selectedCard.classList.add('selected');

            if (isCorrect) {
                gameState.correct++;
                gameState.streak++;
                
                // ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆåå¿œæ™‚é–“ã¨ã‚¹ãƒˆãƒªãƒ¼ã‚¯ãƒœãƒ¼ãƒŠã‚¹ï¼‰
                let baseScore = 100;
                let timeBonus = Math.max(0, 2000 - reactionTime);
                let streakBonus = gameState.streak >= 5 ? gameState.streak * 20 : 0;
                
                let roundScore = Math.floor(baseScore + timeBonus / 10 + streakBonus);
                gameState.score += roundScore;

                // æœ€é«˜ã‚¹ãƒˆãƒªãƒ¼ã‚¯æ›´æ–°
                if (gameState.streak > gameState.maxStreak) {
                    gameState.maxStreak = gameState.streak;
                }

                // çµæœè¡¨ç¤º
                document.getElementById('resultDisplay').innerHTML = 
                    `<span class="result-correct">âœ“ æ­£è§£! +${roundScore}pt</span>`;

                // ã‚¹ãƒˆãƒªãƒ¼ã‚¯ãƒœãƒ¼ãƒŠã‚¹è¡¨ç¤º
                if (gameState.streak >= 5) {
                    document.getElementById('streakDisplay').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('streakDisplay').style.display = 'none';
                    }, 2000);
                }

            } else {
                gameState.streak = 0;
                document.getElementById('resultDisplay').innerHTML = 
                    '<span class="result-incorrect">âœ— ä¸æ­£è§£</span>';
            }

            // åå¿œæ™‚é–“è¡¨ç¤º
            document.getElementById('reactionTime').textContent = `åå¿œæ™‚é–“: ${reactionTime}ms`;

            updateDisplay();

            // 1ç§’å¾Œã«æ¬¡ã®ã‚«ãƒ¼ãƒ‰
            setTimeout(() => {
                if (gameState.isPlaying && !gameState.isPaused) {
                    generateNewCards();
                }
            }, 1000);
        }

        function updateTimer() {
            gameState.timeLeft--;
            updateDisplay();

            if (gameState.timeLeft <= 0) {
                endGame();
            }
        }

        function updateDisplay() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('correct').textContent = gameState.correct;
            document.getElementById('streak').textContent = gameState.streak;
            document.getElementById('timeLeft').textContent = gameState.timeLeft;
        }

        function endGame() {
            gameState.isPlaying = false;
            clearInterval(gameState.gameTimer);

            // çµ±è¨ˆè¨ˆç®—
            const accuracy = gameState.total > 0 ? Math.round((gameState.correct / gameState.total) * 100) : 0;
            const avgReactionTime = gameState.reactionTimes.length > 0 
                ? Math.round(gameState.reactionTimes.reduce((a, b) => a + b, 0) / gameState.reactionTimes.length)
                : 0;

            // çµæœè¡¨ç¤º
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('maxStreak').textContent = gameState.maxStreak;
            document.getElementById('avgReactionTime').textContent = avgReactionTime + 'ms';
            document.getElementById('gameOver').style.display = 'block';

            document.getElementById('startBtn').textContent = 'ã‚²ãƒ¼ãƒ é–‹å§‹';
            document.getElementById('instruction').innerHTML = 'ã‚²ãƒ¼ãƒ çµ‚äº†ï¼<br>æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿ';
        }

        function resetGame() {
            gameState.isPlaying = false;
            gameState.isPaused = false;
            clearInterval(gameState.gameTimer);

            gameState = {
                isPlaying: false,
                isPaused: false,
                score: 0,
                correct: 0,
                total: 0,
                streak: 0,
                maxStreak: 0,
                timeLeft: 60,
                gameTimer: null,
                currentRound: {
                    leftValue: 0,
                    rightValue: 0,
                    startTime: 0
                },
                reactionTimes: []
            };

            document.getElementById('startBtn').textContent = 'ã‚²ãƒ¼ãƒ é–‹å§‹';
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('streakDisplay').style.display = 'none';
            document.getElementById('instruction').innerHTML = 'ã‚ˆã‚Šå¤§ãã„æ•°å­—ã®ã‚«ãƒ¼ãƒ‰ã‚’<br>ã‚¯ãƒªãƒƒã‚¯ã—ã‚ˆã†ï¼';
            document.getElementById('resultDisplay').textContent = '';
            document.getElementById('reactionTime').textContent = 'åå¿œæ™‚é–“: 0ms';

            // åˆæœŸã‚«ãƒ¼ãƒ‰è¡¨ç¤º
            document.getElementById('leftCardValue').textContent = 'A';
            document.getElementById('rightCardValue').textContent = 'K';
            document.getElementById('leftCard').className = 'card black';
            document.getElementById('rightCard').className = 'card black';

            updateDisplay();
        }

        function goBack() {
            if (gameState.gameTimer) clearInterval(gameState.gameTimer);
            window.close();
            window.history.back();
        }

        // åˆæœŸè¡¨ç¤º
        updateDisplay();
    </script>
</body>
</html>