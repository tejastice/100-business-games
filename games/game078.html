<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNOÊà¶Ë°ì - „Ç≤„Éº„É†078</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 20px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .game-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-description {
            font-size: 1.1rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 120px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .game-area {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 20px;
            margin: 20px 0;
            min-height: 500px;
        }

        .player-area {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .player-area.active {
            background: rgba(255, 255, 0, 0.2);
            border: 2px solid #f1c40f;
        }

        .player-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .player-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin: 10px 0;
        }

        .uno-card {
            background: linear-gradient(135deg, #fff, #f8f9fa);
            border: 2px solid #333;
            border-radius: 8px;
            width: 50px;
            height: 75px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            position: relative;
        }

        .uno-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .uno-card.selected {
            border-color: #f1c40f;
            transform: translateY(-8px);
        }

        .uno-card.red { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; }
        .uno-card.blue { background: linear-gradient(135deg, #3498db, #2980b9); color: white; }
        .uno-card.green { background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; }
        .uno-card.yellow { background: linear-gradient(135deg, #f1c40f, #f39c12); color: #333; }

        .card-number {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .card-symbol {
            font-size: 0.8rem;
            margin-top: 2px;
        }

        .central-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .game-field {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .field-title {
            font-weight: bold;
            color: #f1c40f;
        }

        .current-card {
            width: 80px;
            height: 120px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            border: 3px solid #333;
        }

        .game-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .strategy-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .strategy-title {
            font-weight: bold;
            color: #f1c40f;
            margin-bottom: 10px;
        }

        .strategy-content {
            font-size: 0.9rem;
            line-height: 1.4;
            text-align: left;
        }

        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.primary {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .btn.special {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .instructions h3 {
            color: #f1c40f;
            margin-bottom: 15px;
            text-align: center;
        }

        .instructions ul {
            margin-left: 20px;
        }

        .instructions li {
            margin: 8px 0;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .game-area {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .uno-card {
                width: 40px;
                height: 60px;
                font-size: 0.8rem;
            }

            .current-card {
                width: 60px;
                height: 90px;
                font-size: 1.2rem;
            }

            .game-container {
                padding: 20px;
            }

            .stat {
                min-width: 100px;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href = '../index.html'">‚Üê „É°„Éã„É•„Éº„Å´Êàª„Çã</button>

    <div class="game-container">
        <h1 class="game-title">üéØ UNOÊà¶Ë°ì</h1>
        <p class="game-description">UNO„ÅÆÊà¶Áï•ÁöÑ„Ç´„Éº„Éâ„Éó„É¨„Ç§„Å®Ëâ≤„ÉªÊï∞Â≠óÁÆ°ÁêÜ„Å´„Çà„ÇãË®àÁîªÁöÑ„Ç≤„Éº„É†ÈÅãÂñ∂</p>

        <div class="game-stats">
            <div class="stat">
                <div class="stat-label">ÂãùÂà©Êï∞</div>
                <div class="stat-value" id="winCount">0/10</div>
            </div>
            <div class="stat">
                <div class="stat-label">ÂãùÁéá</div>
                <div class="stat-value" id="winRate">0%</div>
            </div>
            <div class="stat">
                <div class="stat-label">Êà¶Áï•ÂäπÊûú</div>
                <div class="stat-value" id="strategyScore">0%</div>
            </div>
            <div class="stat">
                <div class="stat-label">Â¶®ÂÆ≥ÊàêÂäü</div>
                <div class="stat-value" id="interferenceScore">0%</div>
            </div>
        </div>

        <div class="game-area">
            <div class="player-area" id="player1">
                <div class="player-name">„Éó„É¨„Ç§„É§„Éº1</div>
                <div class="player-cards" id="cards1"></div>
                <div class="player-status">ÊâãÊú≠: <span id="count1">7</span>Êûö</div>
            </div>

            <div class="central-area">
                <div class="game-field">
                    <div class="field-title">üéØ ÁèæÂú®„ÅÆ„Ç´„Éº„Éâ</div>
                    <div class="current-card red" id="currentCard">
                        <div class="card-number">5</div>
                        <div class="card-symbol">RED</div>
                    </div>
                    <div id="gameInfo">„Ç≤„Éº„É†„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                </div>
                
                <div class="game-controls">
                    <button class="btn primary" onclick="playCard()" id="playBtn" disabled>„Ç´„Éº„Éâ„ÇíÂá∫„Åô</button>
                    <button class="btn" onclick="drawCard()" id="drawBtn">„Ç´„Éº„Éâ„ÇíÂºï„Åè</button>
                    <button class="btn special" onclick="callUno()" id="unoBtn">UNOÂÆ£Ë®Ä</button>
                </div>
            </div>

            <div class="player-area" id="player2">
                <div class="player-name">„Éó„É¨„Ç§„É§„Éº2</div>
                <div class="player-cards" id="cards2"></div>
                <div class="player-status">ÊâãÊú≠: <span id="count2">7</span>Êûö</div>
            </div>
        </div>

        <div class="game-area" style="grid-template-columns: 1fr 1fr;">
            <div class="player-area" id="player3">
                <div class="player-name">„Éó„É¨„Ç§„É§„Éº3</div>
                <div class="player-cards" id="cards3"></div>
                <div class="player-status">ÊâãÊú≠: <span id="count3">7</span>Êûö</div>
            </div>

            <div class="player-area active" id="playerHuman">
                <div class="player-name">„ÅÇ„Å™„Åü</div>
                <div class="player-cards" id="cardsHuman"></div>
                <div class="player-status">ÊâãÊú≠: <span id="countHuman">7</span>Êûö</div>
            </div>
        </div>

        <div class="strategy-panel">
            <div class="strategy-title">üéØ Êà¶Áï•„Ç¢„Éâ„Éê„Ç§„Çπ</div>
            <div class="strategy-content" id="strategyAdvice">
                Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†„ÇíÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÊâãÊú≠„ÅÆÊßãÊàê„Å®Â†¥„ÅÆÁä∂Ê≥Å„ÇíÂàÜÊûê„Åó„Å¶ÊúÄÈÅ©„Å™Êà¶Áï•„Çí„Ç¢„Éâ„Éê„Ç§„Çπ„Åó„Åæ„Åô„ÄÇ
            </div>
        </div>

        <div class="controls">
            <button class="btn primary" onclick="newGame()">Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†</button>
            <button class="btn special" onclick="showStrategy()">Êà¶Áï•ÂàÜÊûê</button>
        </div>

        <div class="instructions">
            <h3>üìã Ë©≥Á¥∞„É´„Éº„É´„ÉªÈÅä„Å≥Êñπ</h3>
            <ul>
                <li><strong>ÁõÆÁöÑ:</strong> 4‰∫∫ÂØæÊà¶„Åß10„Ç≤„Éº„É†‰∏≠7Âõû‰ª•‰∏äÂãùÂà©„Åó„Å¶ÂãùÁéá70%‰ª•‰∏ä„Åß„ÇØ„É™„Ç¢</li>
                <li><strong>Âü∫Êú¨„É´„Éº„É´:</strong> ÊâãÊú≠„ÇíÊó©„ÅèÁÑ°„Åè„Åó„ÅüÈ†Ü„Å´È†Ü‰Ωç„ÅåÊ±∫„Åæ„ÇãÔºà1‰Ωç„ÅåÂãùÂà©Ôºâ</li>
                <li><strong>„Ç´„Éº„Éâ„ÅÆÁ®ÆÈ°û:</strong>
                    <ul>
                        <li>Êï∞Â≠ó„Ç´„Éº„Éâ: 0-9ÔºàËµ§„ÉªÈùí„ÉªÁ∑ë„ÉªÈªÑÔºâÂêÑËâ≤2Êûö„Åö„Å§Ôºà0„ÅØÂêÑËâ≤1ÊûöÔºâ</li>
                        <li>ÁâπÊÆä„Ç´„Éº„Éâ: „Çπ„Ç≠„ÉÉ„Éó„Éª„É™„Éê„Éº„Çπ„Éª„Éâ„É≠„Éº2ÔºàÂêÑËâ≤2Êûö„Åö„Å§Ôºâ</li>
                        <li>„ÉØ„Ç§„É´„Éâ„Ç´„Éº„Éâ: „ÉØ„Ç§„É´„Éâ„Éª„ÉØ„Ç§„É´„Éâ„Éâ„É≠„Éº4ÔºàÂêÑ4ÊûöÔºâ</li>
                    </ul>
                </li>
                <li><strong>„Éó„É¨„Ç§ÊñπÊ≥ï:</strong>
                    <ul>
                        <li>Â†¥„ÅÆ„Ç´„Éº„Éâ„Å®Âêå„ÅòËâ≤„Åæ„Åü„ÅØÊï∞Â≠ó„ÅÆ„Ç´„Éº„Éâ„ÇíÂá∫„Åô</li>
                        <li>Âá∫„Åõ„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç´„Éº„Éâ„Çí1ÊûöÂºï„Åè</li>
                        <li>ÊâãÊú≠„Åå1Êûö„Å´„Å™„Å£„Åü„Çâ„ÄåUNO„ÄçÂÆ£Ë®ÄÂøÖÈ†à</li>
                        <li>ÁâπÊÆä„Ç´„Éº„Éâ„Éª„ÉØ„Ç§„É´„Éâ„Ç´„Éº„Éâ„ÅßÁõ∏Êâã„ÇíÂ¶®ÂÆ≥</li>
                    </ul>
                </li>
                <li><strong>Êà¶Áï•Ë¶ÅÁ¥†:</strong> „Ç´„Éº„ÉâÁÆ°ÁêÜ„ÄÅËâ≤Êà¶Áï•„ÄÅÁõ∏ÊâãÂ¶®ÂÆ≥„ÄÅ„Çø„Ç§„Éü„É≥„Ç∞Ë™≠„Åø</li>
                <li><strong>Ë©ï‰æ°Âü∫Ê∫ñ:</strong> ÂãùÁéá„ÄÅÊà¶Áï•ÂÆüË°åÁ≤æÂ∫¶„ÄÅÁâπÊÆä„Ç´„Éº„ÉâÊ¥ªÁî®Â∫¶„ÄÅÂ¶®ÂÆ≥ÂäπÊûú„ÇíÁ∑èÂêàË©ï‰æ°</li>
                <li><strong>„ÇØ„É™„Ç¢Êù°‰ª∂:</strong> 10„Ç≤„Éº„É†‰∏≠7Âõû‰ª•‰∏äÂãùÂà©ÔºàÂãùÁéá70%‰ª•‰∏äÔºâ„ÅßUNO„Éû„Çπ„Çø„ÉºË™çÂÆö</li>
            </ul>
        </div>
    </div>

    <script>
        let gameState = {
            players: [
                { name: '„ÅÇ„Å™„Åü', cards: [], isHuman: true },
                { name: '„Éó„É¨„Ç§„É§„Éº1', cards: [], isHuman: false },
                { name: '„Éó„É¨„Ç§„É§„Éº2', cards: [], isHuman: false },
                { name: '„Éó„É¨„Ç§„É§„Éº3', cards: [], isHuman: false }
            ],
            currentPlayer: 0,
            currentCard: null,
            currentColor: '',
            direction: 1,
            gameCount: 0,
            winCount: 0,
            totalGames: 10,
            selectedCard: null,
            gameActive: false,
            strategyEffects: 0,
            interferenceSuccess: 0
        };

        const colors = ['red', 'blue', 'green', 'yellow'];
        const numbers = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
        const specials = ['skip', 'reverse', 'draw2'];
        const wilds = ['wild', 'wilddraw4'];

        function createDeck() {
            const deck = [];
            
            // Êï∞Â≠ó„Ç´„Éº„Éâ
            colors.forEach(color => {
                deck.push({ type: 'number', color: color, value: '0' }); // 0„ÅØÂêÑËâ≤1Êûö
                for (let i = 1; i <= 9; i++) {
                    deck.push({ type: 'number', color: color, value: i.toString() });
                    deck.push({ type: 'number', color: color, value: i.toString() }); // 2Êûö„Åö„Å§
                }
            });
            
            // ÁâπÊÆä„Ç´„Éº„Éâ
            colors.forEach(color => {
                specials.forEach(special => {
                    deck.push({ type: 'special', color: color, value: special });
                    deck.push({ type: 'special', color: color, value: special }); // 2Êûö„Åö„Å§
                });
            });
            
            // „ÉØ„Ç§„É´„Éâ„Ç´„Éº„Éâ
            for (let i = 0; i < 4; i++) {
                deck.push({ type: 'wild', color: 'black', value: 'wild' });
                deck.push({ type: 'wild', color: 'black', value: 'wilddraw4' });
            }
            
            return shuffleDeck(deck);
        }

        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        function dealCards() {
            const deck = createDeck();
            
            // ÂêÑ„Éó„É¨„Ç§„É§„Éº„Å´7ÊûöÈÖç„Çã
            gameState.players.forEach(player => {
                player.cards = [];
                for (let i = 0; i < 7; i++) {
                    player.cards.push(deck.pop());
                }
            });
            
            // ÊúÄÂàù„ÅÆ„Ç´„Éº„Éâ„ÇíÂ†¥„Å´Âá∫„Åô
            do {
                gameState.currentCard = deck.pop();
            } while (gameState.currentCard.type === 'wild');
            
            gameState.currentColor = gameState.currentCard.color;
            gameState.deck = deck;
        }

        function renderCards() {
            gameState.players.forEach((player, index) => {
                const cardsElement = document.getElementById(index === 0 ? 'cardsHuman' : `cards${index}`);
                const countElement = document.getElementById(index === 0 ? 'countHuman' : `count${index}`);
                
                if (player.isHuman) {
                    // „Éó„É¨„Ç§„É§„Éº„ÅÆÊâãÊú≠„ÅØË°®Á§∫
                    cardsElement.innerHTML = player.cards.map((card, cardIndex) => 
                        `<div class="uno-card ${card.color} ${gameState.selectedCard === cardIndex ? 'selected' : ''}" 
                              onclick="selectCard(${cardIndex})">${getCardDisplay(card)}</div>`
                    ).join('');
                } else {
                    // AI„ÅÆÊâãÊú≠„ÅØË£èÈù¢
                    cardsElement.innerHTML = player.cards.map(() => 
                        '<div class="uno-card" style="background: #333;">üÇ†</div>'
                    ).join('');
                }
                
                countElement.textContent = player.cards.length;
            });
            
            // ÁèæÂú®„ÅÆ„Ç´„Éº„ÉâË°®Á§∫
            const currentCardElement = document.getElementById('currentCard');
            currentCardElement.className = `current-card ${gameState.currentColor}`;
            currentCardElement.innerHTML = getCardDisplay(gameState.currentCard);
        }

        function getCardDisplay(card) {
            if (card.type === 'number') {
                return `<div class="card-number">${card.value}</div><div class="card-symbol">${card.color.toUpperCase()}</div>`;
            } else if (card.type === 'special') {
                const symbols = { skip: '‚ö†Ô∏è', reverse: 'üîÑ', draw2: '+2' };
                return `<div class="card-number">${symbols[card.value]}</div><div class="card-symbol">${card.color.toUpperCase()}</div>`;
            } else {
                const symbols = { wild: 'üåà', wilddraw4: 'üåà+4' };
                return `<div class="card-number">${symbols[card.value]}</div><div class="card-symbol">WILD</div>`;
            }
        }

        function selectCard(cardIndex) {
            if (gameState.currentPlayer !== 0 || !gameState.gameActive) return;
            
            gameState.selectedCard = gameState.selectedCard === cardIndex ? null : cardIndex;
            renderCards();
            updateButtons();
        }

        function playCard() {
            if (gameState.selectedCard === null || gameState.currentPlayer !== 0) return;
            
            const card = gameState.players[0].cards[gameState.selectedCard];
            
            if (canPlayCard(card)) {
                gameState.players[0].cards.splice(gameState.selectedCard, 1);
                gameState.currentCard = card;
                gameState.selectedCard = null;
                
                if (card.type !== 'wild') {
                    gameState.currentColor = card.color;
                } else {
                    // „ÉØ„Ç§„É´„Éâ„Ç´„Éº„Éâ„ÅÆÂ†¥Âêà„ÄÅÊà¶Áï•ÁöÑ„Å´Ëâ≤„ÇíÈÅ∏Êäû
                    gameState.currentColor = chooseColor();
                }
                
                executeCardEffect(card);
                
                if (gameState.players[0].cards.length === 0) {
                    endGame(0);
                    return;
                } else if (gameState.players[0].cards.length === 1) {
                    // UNOÁä∂ÊÖã
                    document.getElementById('unoBtn').style.display = 'block';
                }
                
                nextPlayer();
            }
            
            renderCards();
            updateButtons();
            updateStrategy();
        }

        function canPlayCard(card) {
            if (card.type === 'wild') return true;
            return card.color === gameState.currentColor || 
                   card.value === gameState.currentCard.value;
        }

        function chooseColor() {
            // ÊâãÊú≠„ÅßÊúÄ„ÇÇÂ§ö„ÅÑËâ≤„ÇíÈÅ∏Êäû
            const colorCount = {};
            colors.forEach(color => colorCount[color] = 0);
            
            gameState.players[0].cards.forEach(card => {
                if (card.color !== 'black') {
                    colorCount[card.color]++;
                }
            });
            
            return Object.keys(colorCount).reduce((a, b) => 
                colorCount[a] > colorCount[b] ? a : b
            );
        }

        function executeCardEffect(card) {
            if (card.value === 'skip') {
                nextPlayer();
            } else if (card.value === 'reverse') {
                gameState.direction *= -1;
            } else if (card.value === 'draw2') {
                const nextPlayerIndex = getNextPlayer();
                drawCardsForPlayer(nextPlayerIndex, 2);
                nextPlayer();
            } else if (card.value === 'wilddraw4') {
                const nextPlayerIndex = getNextPlayer();
                drawCardsForPlayer(nextPlayerIndex, 4);
                nextPlayer();
            }
        }

        function drawCard() {
            if (gameState.currentPlayer !== 0 || !gameState.gameActive) return;
            
            if (gameState.deck.length === 0) {
                gameState.deck = shuffleDeck(createDeck().slice(0, 50)); // Êñ∞„Åó„ÅÑ„Éá„ÉÉ„Ç≠
            }
            
            gameState.players[0].cards.push(gameState.deck.pop());
            nextPlayer();
            renderCards();
            updateButtons();
            updateStrategy();
        }

        function drawCardsForPlayer(playerIndex, count) {
            for (let i = 0; i < count; i++) {
                if (gameState.deck.length === 0) {
                    gameState.deck = shuffleDeck(createDeck().slice(0, 50));
                }
                gameState.players[playerIndex].cards.push(gameState.deck.pop());
            }
        }

        function callUno() {
            if (gameState.players[0].cards.length === 1) {
                alert('UNOÂÆ£Ë®ÄÔºÅÊÆã„Çä1Êûö„Åß„ÅôÔºÅ');
                document.getElementById('unoBtn').style.display = 'none';
            }
        }

        function nextPlayer() {
            gameState.currentPlayer = getNextPlayer();
            updateActivePlayer();
            
            if (gameState.currentPlayer !== 0) {
                setTimeout(() => aiPlay(), 1000);
            }
        }

        function getNextPlayer() {
            let next = gameState.currentPlayer + gameState.direction;
            if (next >= gameState.players.length) next = 0;
            if (next < 0) next = gameState.players.length - 1;
            return next;
        }

        function updateActivePlayer() {
            document.querySelectorAll('.player-area').forEach(area => {
                area.classList.remove('active');
            });
            
            const activeArea = gameState.currentPlayer === 0 ? 'playerHuman' : `player${gameState.currentPlayer}`;
            document.getElementById(activeArea).classList.add('active');
        }

        function aiPlay() {
            const player = gameState.players[gameState.currentPlayer];
            const playableCards = player.cards.filter(card => canPlayCard(card));
            
            if (playableCards.length > 0) {
                // Êà¶Áï•ÁöÑ„Å´„Ç´„Éº„Éâ„ÇíÈÅ∏Êäû
                const selectedCard = selectBestCard(playableCards, player.cards);
                const cardIndex = player.cards.indexOf(selectedCard);
                
                player.cards.splice(cardIndex, 1);
                gameState.currentCard = selectedCard;
                
                if (selectedCard.type !== 'wild') {
                    gameState.currentColor = selectedCard.color;
                } else {
                    gameState.currentColor = colors[Math.floor(Math.random() * colors.length)];
                }
                
                executeCardEffect(selectedCard);
                
                if (player.cards.length === 0) {
                    endGame(gameState.currentPlayer);
                    return;
                }
            } else {
                // „Ç´„Éº„Éâ„ÇíÂºï„Åè
                drawCardsForPlayer(gameState.currentPlayer, 1);
            }
            
            if (gameState.gameActive) {
                nextPlayer();
            }
            
            renderCards();
            updateButtons();
            updateStrategy();
        }

        function selectBestCard(playableCards, hand) {
            // ÂÑ™ÂÖàÈ†Ü‰Ωç: ÁâπÊÆä„Ç´„Éº„Éâ > „ÉØ„Ç§„É´„Éâ > Êï∞Â≠ó„Ç´„Éº„Éâ
            const specials = playableCards.filter(card => card.type === 'special');
            if (specials.length > 0) return specials[0];
            
            const wilds = playableCards.filter(card => card.type === 'wild');
            if (hand.length <= 3 && wilds.length > 0) return wilds[0];
            
            return playableCards[0];
        }

        function endGame(winnerIndex) {
            gameState.gameActive = false;
            gameState.gameCount++;
            
            if (winnerIndex === 0) {
                gameState.winCount++;
                gameState.strategyEffects++;
            }
            
            const isComplete = gameState.gameCount >= gameState.totalGames;
            const winRate = Math.round((gameState.winCount / gameState.gameCount) * 100);
            
            let message = `„Ç≤„Éº„É† ${gameState.gameCount} ÁµÇ‰∫Ü\n`;
            message += `ÂãùËÄÖ: ${gameState.players[winnerIndex].name}\n`;
            message += `ÁèæÂú®„ÅÆÂãùÁéá: ${winRate}%\n`;
            message += `ÂãùÂà©Êï∞: ${gameState.winCount}/${gameState.gameCount}\n\n`;
            
            if (isComplete) {
                if (winRate >= 70) {
                    message += `üèÜ „ÇØ„É™„Ç¢ÈÅîÊàêÔºÅUNO„Éû„Çπ„Çø„ÉºË™çÂÆöÔºÅ`;
                } else {
                    message += `üí™ „ÇØ„É™„Ç¢Êù°‰ª∂: ÂãùÁéá70%‰ª•‰∏ä`;
                }
            } else {
                message += `Ê¨°„ÅÆ„Ç≤„Éº„É†„Å´ÈÄ≤„Åø„Åæ„Åô`;
            }
            
            alert(message);
            
            if (!isComplete) {
                setTimeout(() => newRound(), 2000);
            }
        }

        function newRound() {
            gameState.currentPlayer = 0;
            gameState.direction = 1;
            gameState.selectedCard = null;
            gameState.gameActive = true;
            
            dealCards();
            renderCards();
            updateButtons();
            updateStrategy();
        }

        function updateStrategy() {
            const hand = gameState.players[0].cards;
            const colorCount = {};
            colors.forEach(color => colorCount[color] = hand.filter(card => card.color === color).length);
            
            const dominantColor = Object.keys(colorCount).reduce((a, b) => 
                colorCount[a] > colorCount[b] ? a : b
            );
            
            let strategy = '';
            
            if (hand.length <= 2) {
                strategy = 'üéØ ÁµÇÁõ§Êà¶Áï•: ÊÆã„ÇäÂ∞ë„Å™„ÅÑÊâãÊú≠„ÄÇÁâπÊÆä„Ç´„Éº„Éâ„ÇÑ„ÉØ„Ç§„É´„Éâ„Ç´„Éº„Éâ„ÅßÁ¢∫ÂÆü„Å´ÂãùÂà©„ÇíÁõÆÊåá„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ';
            } else if (colorCount[dominantColor] >= 3) {
                strategy = `üåà Ëâ≤Êà¶Áï•: ${dominantColor}„ÅåÂ§ö„ÅÑ„Åß„Åô„ÄÇ„Åì„ÅÆËâ≤‰∏≠ÂøÉ„ÅßÊà¶Áï•„ÇíÁµÑ„ÅøÁ´ã„Å¶„Åæ„Åó„Çá„ÅÜ„ÄÇ`;
            } else if (hand.some(card => card.type === 'special' || card.type === 'wild')) {
                strategy = '‚ö° Â¶®ÂÆ≥Êà¶Áï•: ÁâπÊÆä„Ç´„Éº„Éâ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇÁõ∏Êâã„ÅÆÊâãÊú≠„ÅåÂ∞ë„Å™„ÅÑÊôÇ„Å´‰Ωø„Å£„Å¶Â¶®ÂÆ≥„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ';
            } else {
                strategy = 'üé≤ Âü∫Êú¨Êà¶Áï•: Êï∞Â≠ó„Ç´„Éº„Éâ‰∏≠ÂøÉ„Åß„Åô„ÄÇËâ≤„ÇíÊèÉ„Åà„Å™„Åå„ÇâÁ¢∫ÂÆü„Å´„Éó„É¨„Ç§„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ';
            }
            
            document.getElementById('strategyAdvice').textContent = strategy;
        }

        function showStrategy() {
            const hand = gameState.players[0].cards;
            const analysis = analyzeHand(hand);
            alert(`üéØ Ë©≥Á¥∞Êà¶Áï•ÂàÜÊûê\n\n${analysis}`);
        }

        function analyzeHand(hand) {
            const colorCount = {};
            const typeCount = {};
            
            colors.forEach(color => colorCount[color] = 0);
            ['number', 'special', 'wild'].forEach(type => typeCount[type] = 0);
            
            hand.forEach(card => {
                if (card.color !== 'black') colorCount[card.color]++;
                typeCount[card.type]++;
            });
            
            let analysis = `ÊâãÊú≠ÊßãÊàê:\n`;
            Object.entries(colorCount).forEach(([color, count]) => {
                if (count > 0) analysis += `${color}: ${count}Êûö\n`;
            });
            
            analysis += `\nÊé®Â•®Êà¶Áï•:\n`;
            
            const dominantColor = Object.keys(colorCount).reduce((a, b) => 
                colorCount[a] > colorCount[b] ? a : b
            );
            
            if (colorCount[dominantColor] >= 3) {
                analysis += `‚Ä¢ ${dominantColor}Ëâ≤„Çí‰∏≠ÂøÉ„Å®„Åó„ÅüÊà¶Áï•\n`;
            }
            
            if (typeCount.special > 0) {
                analysis += `‚Ä¢ ÁâπÊÆä„Ç´„Éº„Éâ${typeCount.special}Êûö„ÇíÊ¥ªÁî®„Åó„ÅüÂ¶®ÂÆ≥Êà¶Áï•\n`;
            }
            
            if (typeCount.wild > 0) {
                analysis += `‚Ä¢ „ÉØ„Ç§„É´„Éâ„Ç´„Éº„Éâ${typeCount.wild}Êûö„ÇíÊ∏©Â≠ò„Åó„Å¶ÈÄÜËª¢Êà¶Áï•\n`;
            }
            
            return analysis;
        }

        function updateButtons() {
            const playBtn = document.getElementById('playBtn');
            const drawBtn = document.getElementById('drawBtn');
            
            const canPlay = gameState.selectedCard !== null && 
                           gameState.currentPlayer === 0 && 
                           canPlayCard(gameState.players[0].cards[gameState.selectedCard]);
            
            playBtn.disabled = !canPlay;
            drawBtn.disabled = gameState.currentPlayer !== 0 || !gameState.gameActive;
        }

        function updateStats() {
            document.getElementById('winCount').textContent = `${gameState.winCount}/${gameState.totalGames}`;
            
            const winRate = gameState.gameCount > 0 ? 
                Math.round((gameState.winCount / gameState.gameCount) * 100) : 0;
            document.getElementById('winRate').textContent = `${winRate}%`;
            
            const strategyScore = gameState.gameCount > 0 ? 
                Math.round((gameState.strategyEffects / gameState.gameCount) * 100) : 0;
            document.getElementById('strategyScore').textContent = `${strategyScore}%`;
            
            const interferenceScore = gameState.gameCount > 0 ? 
                Math.round((gameState.interferenceSuccess / gameState.gameCount) * 100) : 0;
            document.getElementById('interferenceScore').textContent = `${interferenceScore}%`;
        }

        function newGame() {
            gameState.gameCount = 0;
            gameState.winCount = 0;
            gameState.strategyEffects = 0;
            gameState.interferenceSuccess = 0;
            
            newRound();
            updateStats();
        }

        // „Ç≤„Éº„É†ÂàùÊúüÂåñ
        newGame();
    </script>
</body>
</html>