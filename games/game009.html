<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€£ç¶šåå¿œ - ã‚²ãƒ¼ãƒ 009</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 900px;
            width: 95%;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        .game-title {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-description {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 15px;
            min-width: 100px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .game-area {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            min-height: 500px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .instruction {
            font-size: 1.8rem;
            margin: 20px 0;
            font-weight: bold;
            opacity: 0.9;
        }

        .number-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 400px;
            margin: 30px 0;
            min-height: 300px;
        }

        .number-card {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border: 3px solid white;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .number-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .number-card.clicked {
            background: rgba(76, 175, 80, 0.8);
            animation: pulse 0.3s;
        }

        .number-card.wrong {
            background: rgba(244, 67, 54, 0.8);
            animation: shake 0.5s;
        }

        .number-card.hidden {
            background: rgba(255, 255, 255, 0.1);
            color: transparent;
            border-color: rgba(255, 255, 255, 0.3);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 20%, 40%, 60%, 80%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
        }

        .timer-display {
            font-size: 2rem;
            font-weight: bold;
            color: #ffeb3b;
            margin: 20px 0;
        }

        .sequence-display {
            font-size: 1.5rem;
            margin: 20px 0;
            color: #4caf50;
            font-weight: bold;
        }

        .game-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .skills-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: left;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .skill-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .skill-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .difficulty-selector {
            margin: 20px 0;
        }

        .difficulty-selector select {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 1rem;
        }

        .difficulty-selector option {
            background: #333;
            color: white;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            border-radius: 5px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .phase-indicator {
            font-size: 1.3rem;
            font-weight: bold;
            margin: 10px 0;
            color: #ff9800;
        }

        @media (max-width: 768px) {
            .number-grid {
                grid-template-columns: repeat(3, 1fr);
                max-width: 300px;
            }
            
            .number-card {
                width: 70px;
                height: 70px;
                font-size: 1.5rem;
            }
            
            .instruction {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="goBack()">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>

    <div class="game-container">
        <h1 class="game-title">âš¡ é€£ç¶šåå¿œ</h1>
        <p class="game-description">é€£ç¶šã—ã¦ç¾ã‚Œã‚‹å¤šæ§˜ãªåˆºæ¿€ã«å¯¾ã—ã¦ç´ æ—©ãæ­£ç¢ºã«åå¿œã—ã€æŒç¶šçš„ãªæ³¨æ„åŠ›ã¨åå°„ç¥çµŒã‚’é›ãˆã‚‹é€£ç¶šåå¿œèƒ½åŠ›å‘ä¸Šã‚²ãƒ¼ãƒ </p>

        <div class="game-stats">
            <div class="stat">
                <div class="stat-label">ã‚¹ã‚³ã‚¢</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">ãƒ¬ãƒ™ãƒ«</div>
                <div class="stat-value" id="level">1</div>
            </div>
            <div class="stat">
                <div class="stat-label">æˆåŠŸæ•°</div>
                <div class="stat-value" id="success">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">æ­£è§£ç‡</div>
                <div class="stat-value" id="accuracy">100%</div>
            </div>
        </div>

        <div class="difficulty-selector">
            <label for="difficulty">é›£æ˜“åº¦: </label>
            <select id="difficulty">
                <option value="easy">åˆç´šï¼ˆ3ç§’è¡¨ç¤ºï¼‰</option>
                <option value="normal" selected>ä¸­ç´šï¼ˆ2ç§’è¡¨ç¤ºï¼‰</option>
                <option value="hard">ä¸Šç´šï¼ˆ1.5ç§’è¡¨ç¤ºï¼‰</option>
                <option value="expert">ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆï¼ˆ1ç§’è¡¨ç¤ºï¼‰</option>
            </select>
        </div>

        <div class="game-area">
            <div class="timer-display" id="timer">æº–å‚™å®Œäº†</div>
            <div class="phase-indicator" id="phaseIndicator">ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹</div>
            <div class="instruction" id="instruction">æ•°å­—ã‚’è¨˜æ†¶ã—ã¦ã€æ˜‡é †ã§ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</div>
            <div class="sequence-display" id="sequenceDisplay"></div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="number-grid" id="numberGrid">
                <!-- æ•°å­—ã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
            </div>
        </div>

        <div class="game-controls">
            <button class="btn" id="startBtn" onclick="startGame()">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
            <button class="btn" id="pauseBtn" onclick="pauseGame()" disabled>ä¸€æ™‚åœæ­¢</button>
            <button class="btn" onclick="resetGame()">ãƒªã‚»ãƒƒãƒˆ</button>
            <button class="btn" onclick="goBack()">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
        </div>

        <div class="skills-section">
            <h3>ğŸ¯ ã“ã®ã‚²ãƒ¼ãƒ ã§å‘ä¸Šã™ã‚‹ãƒ“ã‚¸ãƒã‚¹ã‚¹ã‚­ãƒ«</h3>
            <div class="skills-grid">
                <div class="skill-item">
                    <div class="skill-icon">ğŸ§ </div>
                    <h4>çŸ­æœŸè¨˜æ†¶</h4>
                    <p>ä¸€æ™‚çš„ãªæƒ…å ±ã‚’æ­£ç¢ºã«ä¿æŒã™ã‚‹èƒ½åŠ›</p>
                </div>
                <div class="skill-item">
                    <div class="skill-icon">ğŸ”„</div>
                    <h4>é †åºå‡¦ç†</h4>
                    <p>è«–ç†çš„ãªé †åºã§æƒ…å ±ã‚’æ•´ç†ã™ã‚‹èƒ½åŠ›</p>
                </div>
                <div class="skill-item">
                    <div class="skill-icon">ğŸ‘ï¸</div>
                    <h4>è¦–è¦šè¨˜æ†¶</h4>
                    <p>è¦–è¦šçš„æƒ…å ±ã‚’è¨˜æ†¶ãƒ»å†ç¾ã™ã‚‹èƒ½åŠ›</p>
                </div>
                <div class="skill-item">
                    <div class="skill-icon">âš¡</div>
                    <h4>å‡¦ç†é€Ÿåº¦</h4>
                    <p>ç´ æ—©ãæ­£ç¢ºã«åˆ¤æ–­ãƒ»å®Ÿè¡Œã™ã‚‹èƒ½åŠ›</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            score: 0,
            level: 1,
            success: 0,
            total: 0,
            isPlaying: false,
            isPaused: false,
            phase: 'ready', // ready, memorize, recall
            currentSequence: [],
            playerSequence: [],
            currentNumbers: [],
            difficulty: 'normal',
            sequenceLength: 3,
            showTimer: null,
            hideTimer: null,
            currentIndex: 0
        };

        const difficultySettings = {
            easy: { showTime: 3000, startLength: 3, pointMultiplier: 1 },
            normal: { showTime: 2000, startLength: 4, pointMultiplier: 1.5 },
            hard: { showTime: 1500, startLength: 5, pointMultiplier: 2 },
            expert: { showTime: 1000, startLength: 6, pointMultiplier: 3 }
        };

        function startGame() {
            if (gameState.isPlaying) return;
            
            gameState.isPlaying = true;
            gameState.isPaused = false;
            gameState.difficulty = document.getElementById('difficulty').value;
            gameState.sequenceLength = difficultySettings[gameState.difficulty].startLength;
            gameState.level = 1;
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('difficulty').disabled = true;
            
            startRound();
        }

        function startRound() {
            if (!gameState.isPlaying || gameState.isPaused) return;
            
            gameState.phase = 'memorize';
            gameState.playerSequence = [];
            gameState.currentIndex = 0;
            
            updatePhaseIndicator();
            generateSequence();
            showSequence();
        }

        function generateSequence() {
            // 1ã‹ã‚‰16ã®æ•°å­—ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ
            const availableNumbers = Array.from({length: 16}, (_, i) => i + 1);
            gameState.currentNumbers = [];
            
            // å¿…è¦ãªæ•°ã ã‘ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ
            for (let i = 0; i < gameState.sequenceLength; i++) {
                const randomIndex = Math.floor(Math.random() * availableNumbers.length);
                gameState.currentNumbers.push(availableNumbers[randomIndex]);
                availableNumbers.splice(randomIndex, 1);
            }
            
            // æ­£è§£ã®é †åºã¯æ˜‡é †
            gameState.currentSequence = [...gameState.currentNumbers].sort((a, b) => a - b);
            
            createNumberGrid();
        }

        function createNumberGrid() {
            const grid = document.getElementById('numberGrid');
            grid.innerHTML = '';
            
            // 16å€‹ã®ã‚«ãƒ¼ãƒ‰ã‚’ä½œæˆï¼ˆä½¿ç”¨ã™ã‚‹æ•°å­—ã¨ç©ºã®ã‚«ãƒ¼ãƒ‰ï¼‰
            const allPositions = Array.from({length: 16}, (_, i) => i);
            const shuffledNumbers = [...gameState.currentNumbers];
            
            // ã‚·ãƒ£ãƒƒãƒ•ãƒ«
            for (let i = shuffledNumbers.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledNumbers[i], shuffledNumbers[j]] = [shuffledNumbers[j], shuffledNumbers[i]];
            }
            
            for (let i = 0; i < 16; i++) {
                const card = document.createElement('div');
                card.className = 'number-card';
                
                if (i < gameState.currentNumbers.length) {
                    card.textContent = shuffledNumbers[i];
                    card.dataset.number = shuffledNumbers[i];
                    card.addEventListener('click', () => selectNumber(parseInt(shuffledNumbers[i])));
                } else {
                    card.style.visibility = 'hidden';
                }
                
                grid.appendChild(card);
            }
        }

        function showSequence() {
            document.getElementById('instruction').textContent = 'æ•°å­—ã‚’è¨˜æ†¶ã—ã¦ãã ã•ã„';
            document.getElementById('sequenceDisplay').textContent = `è¨˜æ†¶ã™ã‚‹æ•°å­—: ${gameState.currentNumbers.join(', ')}`;
            
            const showTime = difficultySettings[gameState.difficulty].showTime;
            let timeLeft = Math.ceil(showTime / 1000);
            
            updateTimer(timeLeft);
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                updateTimer(timeLeft);
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    hideSequence();
                }
            }, 1000);
        }

        function hideSequence() {
            gameState.phase = 'recall';
            updatePhaseIndicator();
            
            document.getElementById('instruction').textContent = 'æ•°å­—ã‚’æ˜‡é †ã§ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„';
            document.getElementById('sequenceDisplay').textContent = `æ­£è§£é †åº: ${gameState.currentSequence.join(' â†’ ')}`;
            document.getElementById('timer').textContent = 'å…¥åŠ›ä¸­...';
            
            // æ•°å­—ã‚«ãƒ¼ãƒ‰ã‚’éš ã™
            const cards = document.querySelectorAll('.number-card');
            cards.forEach(card => {
                if (card.dataset.number) {
                    card.classList.add('hidden');
                }
            });
            
            // å°‘ã—å¾…ã£ã¦ã‹ã‚‰è¡¨ç¤º
            setTimeout(() => {
                cards.forEach(card => {
                    if (card.dataset.number) {
                        card.classList.remove('hidden');
                    }
                });
            }, 500);
        }

        function selectNumber(number) {
            if (gameState.phase !== 'recall' || !gameState.isPlaying || gameState.isPaused) return;
            
            const expectedNumber = gameState.currentSequence[gameState.currentIndex];
            const card = document.querySelector(`[data-number="${number}"]`);
            
            if (number === expectedNumber) {
                // æ­£è§£
                card.classList.add('clicked');
                gameState.playerSequence.push(number);
                gameState.currentIndex++;
                
                if (gameState.currentIndex >= gameState.currentSequence.length) {
                    // ãƒ©ã‚¦ãƒ³ãƒ‰å®Œäº†
                    completeRound(true);
                }
            } else {
                // é–“é•ã„
                card.classList.add('wrong');
                setTimeout(() => {
                    card.classList.remove('wrong');
                }, 500);
                
                completeRound(false);
            }
        }

        function completeRound(success) {
            gameState.total++;
            
            setTimeout(() => {
                if (success) {
                    gameState.success++;
                    
                    // ã‚¹ã‚³ã‚¢è¨ˆç®—
                    const basePoints = 100;
                    const lengthBonus = gameState.sequenceLength * 20;
                    const levelBonus = gameState.level * 10;
                    const difficultyBonus = Math.floor(basePoints * difficultySettings[gameState.difficulty].pointMultiplier);
                    const points = basePoints + lengthBonus + levelBonus + difficultyBonus;
                    
                    gameState.score += points;
                    
                    document.getElementById('instruction').textContent = `æ­£è§£ï¼ +${points}ç‚¹`;
                    
                    // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯
                    if (gameState.success % 3 === 0) {
                        gameState.level++;
                        gameState.sequenceLength = Math.min(gameState.sequenceLength + 1, 12);
                        showLevelUpMessage();
                    }
                } else {
                    document.getElementById('instruction').textContent = 'é–“é•ã„ï¼æ­£è§£é †åºã‚’ç¢ºèªã—ã¦ãã ã•ã„';
                }
                
                updateDisplay();
                
                setTimeout(() => {
                    if (gameState.isPlaying) {
                        startRound();
                    }
                }, 2000);
            }, 1000);
        }

        function showLevelUpMessage() {
            document.getElementById('phaseIndicator').textContent = `ğŸ‰ ãƒ¬ãƒ™ãƒ« ${gameState.level} é”æˆï¼`;
            
            setTimeout(() => {
                updatePhaseIndicator();
            }, 2000);
        }

        function updatePhaseIndicator() {
            const indicator = document.getElementById('phaseIndicator');
            
            switch (gameState.phase) {
                case 'ready':
                    indicator.textContent = 'ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹';
                    break;
                case 'memorize':
                    indicator.textContent = 'ğŸ“ è¨˜æ†¶ãƒ•ã‚§ãƒ¼ã‚º';
                    break;
                case 'recall':
                    indicator.textContent = 'ğŸ¯ å…¥åŠ›ãƒ•ã‚§ãƒ¼ã‚º';
                    break;
            }
        }

        function updateTimer(seconds) {
            document.getElementById('timer').textContent = `æ®‹ã‚Šæ™‚é–“: ${seconds}ç§’`;
        }

        function pauseGame() {
            if (!gameState.isPlaying) return;
            
            gameState.isPaused = !gameState.isPaused;
            
            if (gameState.isPaused) {
                clearTimeout(gameState.showTimer);
                clearTimeout(gameState.hideTimer);
                document.getElementById('pauseBtn').textContent = 'å†é–‹';
                document.getElementById('instruction').textContent = 'ä¸€æ™‚åœæ­¢ä¸­';
            } else {
                document.getElementById('pauseBtn').textContent = 'ä¸€æ™‚åœæ­¢';
                if (gameState.phase === 'memorize') {
                    showSequence();
                } else {
                    updatePhaseIndicator();
                }
            }
        }

        function resetGame() {
            clearTimeout(gameState.showTimer);
            clearTimeout(gameState.hideTimer);
            
            gameState = {
                score: 0,
                level: 1,
                success: 0,
                total: 0,
                isPlaying: false,
                isPaused: false,
                phase: 'ready',
                currentSequence: [],
                playerSequence: [],
                currentNumbers: [],
                difficulty: 'normal',
                sequenceLength: 3,
                showTimer: null,
                hideTimer: null,
                currentIndex: 0
            };
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('difficulty').disabled = false;
            document.getElementById('pauseBtn').textContent = 'ä¸€æ™‚åœæ­¢';
            document.getElementById('instruction').textContent = 'æ•°å­—ã‚’è¨˜æ†¶ã—ã¦ã€æ˜‡é †ã§ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„';
            document.getElementById('sequenceDisplay').textContent = '';
            document.getElementById('timer').textContent = 'æº–å‚™å®Œäº†';
            document.getElementById('numberGrid').innerHTML = '';
            
            updatePhaseIndicator();
            updateDisplay();
            updateProgress();
        }

        function endGame() {
            gameState.isPlaying = false;
            clearTimeout(gameState.showTimer);
            clearTimeout(gameState.hideTimer);
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('difficulty').disabled = false;
            document.getElementById('instruction').textContent = 'ã‚²ãƒ¼ãƒ çµ‚äº†ï¼';
            
            showGameResults();
        }

        function showGameResults() {
            const accuracy = gameState.total > 0 ? Math.round((gameState.success / gameState.total) * 100) : 0;
            const performance = getPerformanceRating(gameState.score, accuracy, gameState.level);
            
            alert(`ğŸ”¢ ã‚²ãƒ¼ãƒ çµæœ
            
ã‚¹ã‚³ã‚¢: ${gameState.score}ç‚¹
ãƒ¬ãƒ™ãƒ«: ${gameState.level}
æˆåŠŸæ•°: ${gameState.success}/${gameState.total}
æ­£è§£ç‡: ${accuracy}%

ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: ${performance}

ãƒ“ã‚¸ãƒã‚¹ã‚¹ã‚­ãƒ«å‘ä¸Šåº¦:
ğŸ§  çŸ­æœŸè¨˜æ†¶: ${getSkillRating(gameState.level * 200)}
ğŸ”„ é †åºå‡¦ç†: ${getSkillRating(gameState.success * 100)}
ğŸ‘ï¸ è¦–è¦šè¨˜æ†¶: ${getSkillRating(accuracy * 15)}
âš¡ å‡¦ç†é€Ÿåº¦: ${getSkillRating(gameState.score / 10)}`);
        }

        function getPerformanceRating(score, accuracy, level) {
            if (score >= 2000 && accuracy >= 90 && level >= 8) return 'ğŸ† ã‚¨ã‚¯ã‚»ãƒ¬ãƒ³ãƒˆ';
            if (score >= 1500 && accuracy >= 80 && level >= 6) return 'ğŸ¥‡ ã¨ã¦ã‚‚è‰¯ã„';
            if (score >= 1000 && accuracy >= 70 && level >= 4) return 'ğŸ¥ˆ è‰¯ã„';
            if (score >= 500 && accuracy >= 60 && level >= 3) return 'ğŸ¥‰ æ™®é€š';
            return 'ğŸ“ˆ è¦ç·´ç¿’';
        }

        function getSkillRating(value) {
            if (value >= 1500) return 'â˜…â˜…â˜…â˜…â˜… ãƒã‚¹ã‚¿ãƒ¼';
            if (value >= 1200) return 'â˜…â˜…â˜…â˜…â˜† ä¸Šç´š';
            if (value >= 900) return 'â˜…â˜…â˜…â˜†â˜† ä¸­ç´š';
            if (value >= 600) return 'â˜…â˜…â˜†â˜†â˜† åˆç´š';
            return 'â˜…â˜†â˜†â˜†â˜† åŸºç¤';
        }

        function updateDisplay() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('success').textContent = gameState.success;
            
            const accuracy = gameState.total > 0 ? Math.round((gameState.success / gameState.total) * 100) : 100;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }

        function updateProgress() {
            const progress = gameState.total > 0 ? (gameState.success / Math.max(gameState.total, 10)) * 100 : 0;
            document.getElementById('progressFill').style.width = Math.min(progress, 100) + '%';
        }

        function goBack() {
            if (gameState.isPlaying) {
                if (confirm('ã‚²ãƒ¼ãƒ ã‚’çµ‚äº†ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ')) {
                    resetGame();
                    window.close();
                    window.history.back();
                }
            } else {
                window.close();
                window.history.back();
            }
        }

        // åˆæœŸè¡¨ç¤º
        updateDisplay();
        updateProgress();
        updatePhaseIndicator();
    </script>
</body>
</html>